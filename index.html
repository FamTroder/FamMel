<!--suppress XmlHighlighting -->
<html lang="en">
<head>
<!--    TODO fix this obsolete attribute, i.e. move this to the css file-->
    <style type="text/css">
        body {
            font-family: sans-serif;
        }

        a:hover {
            color: #888800;
        }

        a {
            text-decoration: none;
            color: #000088;
        }
    </style>
    <meta charset="UTF-8">
<!-- TODO sort out imports?-->
    <script src="scripts/main.js"></script>
    <script src="scripts/quotes.js"></script>
    <script src="scripts/animation.js"></script>
    <script src="scripts/settings.js"></script>
    <script src="scripts/images.js"></script>
    <script src="scripts/yourhome.js"></script>
    <script src="scripts/objects.js"></script>
    <script src="scripts/actions.js"></script>
    <script src="scripts/bladder.js"></script>
    <script src="scripts/yourbladder.js"></script>
    <script src="scripts/clothes.js"></script>
    <script src="scripts/herhome.js"></script>
    <script src="scripts/drive.js"></script>
    <script src="scripts/locations/driveAround.js"></script>
    <script src="scripts/locations/theBar.js"></script>
    <script src="scripts/locations.js"></script>
    <script src="scripts/games/darts.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <title>Melissa Explains it All</title>
</head>
<body>
<script>
    /*

   Since last release ( 3.0 )

    RECENT REQUESTS ( actual requests ):
1)  Different clothing for different girls
2)  More than 1 girl at the same time
3)  When she wets herself, starts losing slowly, a squirt, a wet patch, a bigger patch, then loses entirely.
4)  Player also has bladder & pee need.

    RECENT CHANGES:

1)  Ability to make a custom girl
2)  Elevator hijinx - she can wet herself, and sometimes
    somebody comes out of the elevator.
3)  New outfit: jeans and black tee - both tight.
4)  Records empty champagne bottle
5)  Bladder size reduces when she holds it too long.
6)  Enhanced debug mode
7)  Flirting with the lady bartender in the club -> jelousy
8)  Began modification for solo activities and started solo bargirl scene.
8A)  Somewhat Enhanced solo bargirl scene.
9)  Made wetting the bed a non-losing option.
10) Added possibility to take her keys or cellphone when you let her go pee.
11) Added lost keys functionality to apartment
12)  Massively Enhanced solo bargirl scene.

    STUFF TO FIX:

    STUFF TO ADD:

1) Bladder Buster night randomly available in the bar.  Bathroom
   continuously locked rather than just randomly locked.
2) She tries to pee in a glass under the table in the bar if she has to go bad.
3) You ask her to take a camera into the bathroom with her.
4) You can abandon the date:
    - You excuse yourself to go to the restroom?
    After which:
        - hole in the wall to see inside the ladies room with a line
        - pick up an escort
        - should there be a lady bartender?
5) You "find" objects of power:
    - magic bladder gun?
    - diuretic pills?
    - remote control?
6) More games - truth or dare?
7) She left her keys in your car...
8) Flesh out the stuff you see while you're driving
9) Solo Hotel:
   - Front office girl is stuck and has to pee
   - Room service girl brings & shares champagne
   - Escort in-call


=========================
FIXES BY OLRAST

3.2.1

* Setting custom girl bladder capacity works now
* When using a custom girl with JPG pictures, pictures of the girl she's based on are displayed

3.2.2

* Fixed image flicker

3.2.3

* Removed tracking code (injected by a hosting site?)

============================
CHANGES BY Forget_About_Me

4.0

*fixed some game-breaking bugs with rarer scenes
*General bug fixes
*changed the html so now the game is in the full browser screen instead of only part of it.
*You can now kiss and feel her up in the dark bar
*Added a make-out option to the hot tub
*Clothes now get reset when leaving a make-out session(beach and hot-tub)
*fixed some typos
*Added the option to be able to repeat actions during a make-out/sex session
*Added the option to have actions reset between make-out/sex sessions
*In the theatre you can now ask her which movie she wants to watch
*Tweaked the success of actions during the movie a bit.
*Implemented PlayerBladder - needs better scenes

=====================

4.1

*Added possibilities for you to pee when the bathroom is unavailable
*Tweaked how the bladders fill a tiny bit. Not noticeable for players.
*fixed a bug where you didn't lose control during the drinking game
*Slight code cleanup
*She no longer takes the vase/shot glass to the bathroom with her when you are in the car/outside
*At the end of the drinking game you no longer automatically go to the bathroom
*She no longer asks for the bar if you have already been there
*When you're alone she will no longer ask you to hold her purse
*You can now set a custom capacity for your bladder
*increased the amount of money you have, since you now also need to buy for yourself
*You can now only go to the bathroom if you actually need to go
*You can now pee in the tub
*You now can't have sex with her if she is still wearing bottoms
*You no longer can change the options mid-game
*Fixed a bug that caused a line to be said twice
*You no longer automatically lose attraction if you ask her to hold it and she's not desperate
*Started organizing the clutter that happens when you have a lot of items
*You can now drink with her
*You can ask her how she is doing when she's holding it for you
*Added an option to change how much money you have

==================

4.2

*Tweaked the chance of spurting instead of fully wetting
*Fixed a game breaking bug in the drinking game
*Changed the chance she'll hold it if you ask when she's desperate
*Code cleanup
*Fixed the bug were bladder-limits weren't updated when choosing a preset girl
*Fixed that you still drink soda even if you're tummy is full
*Fixed the bug where she only asks for the bar, all the time
*First start on splitting the code into multiple files
*Changed the way stats are handled to be a bit more elegant
*Replaced all deprecated code
*Changed lost attraction if you make her drink while desperate
*Fixed that the wrong dialogue appears when you lose control during the drinking game
*Changed end scenes for the drinking game
*You can now keep buying drinks in a row.

========
0.5.0

*Moving quotes to JSON
*Settings are now saved between sessions
*Fixed the loop with a certain end-scene of the drinking game
*Changed the way pictures are added
*Changed with how much cocktails increase max-tummy
*Tweaked chance of finding key to hopefully be a bit more favourable
*Fixed bug that reset the flirt counter when trying to leave
*Fixed preventpee being called if she doesn't have to go during pickup
*Fixed that you and her use the same counter for a locked bathroom
*Changed volume of water bottles and beer to 250ml to be slightly more realistic
*Added option to turn off playerBladder
*Added a backpack which works as an inventory
*Removed debug mode
*Added the option to always ask her to pee into something, without caring about her need
*Added a gas station
*Tweaked the insistent asking to pee:
    * WaitCounter now takes into account bladder size. With a minimum amount
    * WaitCounter is only ignored if she's genuinely within 2 ticks of wetting
*When selling panties you now get the option to buy more beer.
*Added more topics for talking in the bar.
*/

    //TODO potentially clean up if statements with multiple locations
    //TODO fix replacing whole arrays if not needed

    // Debug Parameters
    let enableimages = 0; // 0 = Disable image loading
    let enableascii = 1; // 0 = Disable ascii art display
    let enablehide = 0; // 1 = Hide screen

    let showstats = 1; // 1 = Show her bladder state, etc.
    // Girl Selection Parameters
    let photolevel = 0; // 0 = clothed, 1 = costumed, 2 = to be naked, 3 = naked.

    let girlname = "Laura";
    let customgirlname = "Amanda";
    let basegirl = "Laura";
    let girltalk = "<b>" + girlname + ":&nbsp;</b>";
    let girlgasp = "<b>" + girlname + " gasps:&nbsp;</b>";
    let favoritemovie = "theurge";
    let suggestedloc = "thebar";

    let heroutfit = "jeans";  //  Her clothing choice for the date
                              //  Possible values: skirt, jeans

    const clubclosingtime = 7 * 60; // 2:00AM
    const theaterclosingtime = 3 * 60; // 10:00PM last showing
    const barclosingtime = 6 * 60; // 1:00AM

    let money = 200;
    let attraction = 10;
    let tummy = 100;
    let bladder = 300;
    let shyness = 90;

    let tumavg = tummy; // Average blood water level
    const tumdecay = 6; // Number of calculation cycles to average bladder filling

    let lastmoney = money;
    let lastattraction = attraction;
    let lastshyness = shyness;

    let hour = 7;
    let minute = 0;
    let meridian = "PM";
    const timespeed = 2;
    let thetime = 0;

    // Fucking Parameters, mostly to figure out what she still has on.
    let arousal = 0;
    let kisscounter = 0;
    let feelcounter = 0;
    let xskirt = 0;
    let xtop = 0;
    let xbra = 0;
    let xpanties = 0;
    let kneck = 0;
    let kthigh = 0;
    let kpussy = 0;
    let kbreast = 0;
    let tthigh = 0;
    let tpussy = 0;
    let tbreast = 0;
    let tass = 0;
    let fuckingnow = 0; // You are in the middle of fucking.
    let multiplemoves = 1;
    let rstmoves = 0; //Whether the sex moves reset after a make-out session
    //Formatting Parameters
    let ulopen = 0; // Formatting : flags if <ul> has been made.
    let slopen = 0; // Formatting : flags if string has been placed.
    let imageprev = "imgs/Laura/pixnorm.gif";  // Previous image
    const imagedesc = '"Picture of girl"';
    let imagename = imageprev;  // Actual picture.  Goes to default after 1 turn.
    let comma = 0; // used in formatting posessions.

    //Counter Parameters
    const maxkiss = 7; // maximum number of kisses that have effect.
    const maxfeel = 7; // maximum number of feel-ups that have effect

    const randmax = 5; // Maximum value of random counter
    const maxpstory = 8; // Maximum value of story counter
    let pstorycounter = 0;
    let oldpstorycounter = pstorycounter;

    let posectr = 0; // keep track of which pose is next/last.
    const posemax = 5; // Maximum value of pose counter

    let outfitctr = 0; // keep track of the outfit being worn.
    const outfitmax = 5; // maximum count of outfits


    //  Randomness thresholds 1-10.
    //  1 corresponds to 10% likelihood.
    //  10 corresponds to 100% likelihood.
    const rrlockedthresh = 7; // Likelihood of bar restroom locked ( occupied )
    const rrlinethresh = 7; // Likelihood of line for restroom in club
    const phoneholdthresh = 7; // Likelihood of her holding it for you on the phone
    let spurtthresh = 5; // Likelihood of her spurting rather than wetting
    let yspurtthresh = 3; // Likelihood of you spurting rather than wetting
    let bribeaskthresh = 8; //Likelihood she'll hold it if you ask her when desperate
    let lookaroundthresh = 5; //Likelihood you'll find a key when looking around.

    //  Attraction thresholds
    const ptogetherthreshold = 100; // She'll take you with her to the bathroom.
    const pnorestroomthreshold = 110; // She'll pee outside of the restroom.
    const pwatchthreshold = 90; // You can watch her pee in a closed place.
    const drinkinggamethreshold = 90; // She'll play your silly drinking game.
    const photogamethreshold = 90; // She'll play your silly photo game
    const photogamecthreshold = 100; // She'll play your silly photo game in costume
    const photogamenthreshold = 110; // She'll play your silly photo game nude
    const hottubthresh = 90; //  She'll strip and go into the hot tub
    const holditneedthresh = 30; // She'll hold it for need
    const holditemerthresh = 60; // She'll hold it for emergency
    const holditlosethresh = 90; // She'll try to hold it for lose
    const gomakeoutthresh = 40; // She'll go to the makeout spot


    //  Location handling stack
    //  initialized at the start.
    const locstack = Array(); //The first element in the Array is the current location

    //  flags
    // Indicates new venue change
    let didintro = 0; // Flag for having done introduction
    let onphone = 0; // Flag for being on the phone with her
    let shopping = 0;// Flag for being in the shop
    let seenmovie = 0; // Flag for having seen a movie already
    let beenbar = 0;  //  Been to the bar already
    let beenclub = 0; // Been to the club already
    let beenmakeout = 0; // Seen a movie already
    let flirtedflag = 0; // Actually a counter.  Keeps track of flirting.
    const maxflirts = 2; // Maximum flirt points per venue
    //TODO lockedflags  should probably be renamed counters
    let rrlockedflag = 0; // Restroom was locked last time she went
    let yrrlockedflag = 0;
    let askedswim = 0; // She's asked about a swim
    let wetthecar = 0; // Seat of the car is wet
    let shespurted = 0; // She only spurted
    let brokeice = 0; // She's previously brought up that she needs to pee
    let sawherpee = 0; // You've seen her pee
    let haveherpurse = 0; // You're holding her purse
    let late = 0; //You are late to pick her up

    let bartopic = 0; // Topics of discussion at the bar.
    let noflirtflag = 0; // Suppress flirty options

    let externalflirt = 0; // You flirted with somebody else

    let roses = 0; // flowers object counter
    let water = 0; // water bottle object counter
    //TODO limit what vase can hold
    let vase = 0; // vase object counter
    let ptowels = 0; // paper towel object counter
    let panties = 0; // panties object counter
    let champagne = 0; // champagne object counter
    let shotglass = 0; // shot glass object
    let earrings = 0; // earrings object counter
    let hercellphone = 0; // cellphone object counter
    let herkeys = 0; // her keys object counter

    let wetpanties = 0; // wet panties object
    let beer = 0; // beer bottle object ( increased bladder cap on beer only )
    let cocktail = 0; // cocktail object ( each increases maxtummy by 100 )
    let soda = 0; // soda object ( This is a 500ml soda. )

    // Keys to the buildings
    let barkey = 0; // key to the bar
    let clubkey = 0; // key to the club
    let theaterkey = 0; // key to the theater

    // Girl stats(Counter and Flags)
    let owedfavor = 0; // she owes you a favor
    let pantycolor = "black";
    let flirtcounter = 0; // time since last flirt ( counts by 2 )
    let wetlegs = 0; // her legs are wet
    let wetherpanties = 0; // did she ever wet herself?
    let prepeed = 0; // did she pee before you picked her up
    let champagnecounter = 0; // Number of glasses of champagne served.
    //TODO figure out where gottagoflag is actually used
    let gottagoflag = 0; // has she just asked to use the restroom
    let showedneed = 0; // has she just visually displayed her need
    let changevenueflag = 0; // you are changing venue - makes her easily ask to pee.
    let moviecounter = 0; // Keep track of location in movie
    let moviechoice = 0; //  Which movie are we showing
    let askedfavourite = 0; //asked her which movie to watch

    let askholditcounter = 0; // How many times have you asked her to hold it.
    let waitcounter = 0; // how long ago did she ask to pee?
                         //Reset positive when you ask her.

    let nowpeeing = 0; // She is currently peeing
    let ynowpeeing = 0; // You're currently peeing
    let checkedherout = 0; // Flags that you just checked her out.

    let walkcounter = 0; // How far have you walked
    let elevatorwaitcounter = 0;



    /*
  -----------------------------------------------------------------
  GAME TEXT

   Most, but not all of the text in the game is stored in arrays.
   Note that all text with the girl's name in it has to be redefined
   later ( options dialog ) if the name of the girl is changed.
  -----------------------------------------------------------------
*/

    //
    //
    //  First set all the clothing related variables we're going to
    //  have as globals...  This is so she can have different outfits
    //  in normal life.  It's a lot of work, isn't it?
    //
    //

    let thighresp;
    let feelher;
    let feelres;
    let feelpee;
    let feelyou;
    let feelbad;
    let posenorm;
    let poseoutfit;
    let donoutfit;
    let donemer;
    let fillchampok;
    let stareather_laura;
    let stareather_karen;
    let stareather_jennifer;
    let stareather_melissa;
    let stareather;
    let dryquote;
    let peeshotquote;
    let peeshotquotebare;
    let peeskirtquote;
    let peeskirtquotebare;
    let peetowelquote;
    let peetowelquotebare;
    let peeoutsidequote;
    let peeoutsidequotebare;
    let peeoutsidebquote;
    let peeoutsidebquotebare;
    let wetherselfquote;
    let firstmtgquote;
    let firstmtgtightquote;
    let firstmtgtightquotebare;
    let soakedseatquote;
    let peeprepquote;
    let peeprepquotebare;
    let undressquote;
    let undressquoteemer;
    let ptogetherquote;
    let ptogetherquotebare;
    let ptogetheroutquote;
    let ptogetheroutquotebare;
    let finishtogethroutquote;
    let finishtogetheroutquotebare;
    let ptogetherdumpquote;
    let ptogetherdumpquotebare;
    let finishtogetherdumpquote;
    let finishtogetherdumpquotebare;

    let sextakeoffskirt;
    let sextakeoffblouse;

    let sextouchthighquote;
    let sextouchassquote;
    let sextouchpussyquote;
    let sexkissthighquote;
    let sexkisspussyquote;

    let sextoskirtquoteemer;
    let sextoskirtquote;
    let sextoskirtquotebare;
    let sextopantiesquote;
    let swimstripquote;
    let swimstripquotebare;
    let swimstripquotepanties;

    //TODO figure out dependencies
    //
    // Bartender quotes
    //
    // let barquotes = ["Nice girl you've got there.  Bet she'll pee herself if she holds a drop over " + bladlose + "ml, though.",
    //     "She's cute, isn't she?  I bet if you found her a cocktail, she'd be a lot less inhibited about drinking.",
    //     "Did you know that beer is a diuretic?",
    //     "Say, you don't happen to know where a man could buy a set of wet panties around here, do you?",
    //     "How about them Dodgers?",
    //     "I've been thinking about starting a bladder buster night here on Mondays."];


    //
    //  She loses control
    //
    let wetquote = ["Suddenly, " + girlname + " squeals and then gasps!",
        "Suddenly, " + girlname + " freezes in place and her face turns bright red.",
        girlname + " gasps and grabs at her pussy.",
        girlname + " squeals and doubles over.",
        girlname + " suddenly gasps and her face turns red.",
        girlname + " suddenly shudders and her face turns red."];

    //
    //  How the girl responds to what you say indicates good or bad answer
    //
    // let bargoodresp = [girlname + " looks you in the eyes and smiles as she talks.",
    //     girlname + " leans towards you and smiles.",
    //     girlname + " seems pleased with the conversation.",
    //     "You feel " + girlname + "'s foot playfully brush your leg, and she smiles as she talks",
    //     girlname + " touches your shoulder gently.",
    //     girlname + " seems to be playing with the top button of her blouse as she talks."];
    //
    // let barmedresp = [girlname + " seems uninterested in the conversation.",
    //     girlname + " twirls her hair around her finger as she talks.",
    //     girlname + " leans back in her chair.",
    //     girlname + " glances around the room.",
    //     girlname + " fiddles with her napkin.",
    //     girlname + " glances quickly at her watch."];
    //
    // let barbadresp = [girlname + " leans back in her chair and sighs.",
    //     girlname + " frowns.",
    //     girlname + " looks pointedly at her watch.",
    //     girlname + " seems more interested in shredding her napkin into little strips that what you have to say.",
    //     girlname + " appears engrossed in the program on the bar television ... which is an infomercial for Arizona real estate.",
    //     girlname + " looks exasperated."];

    /*

  -----------------------------------------------------------------

  DISPLAY MECHANICS

  Stuff that writes to the screen.

  -----------------------------------------------------------------

*/
    // Cache a statement
    //    t - the text to display.
    function s(t) {
        document.getElementById('textsp').innerHTML += t + "<p>";
    }


    //TODO this probably can be done more efficient
    function goback() {
        if (locstack[0] === "beachsex") {
            s("You both slowly get up from the sand and dust yourselves off.");
            s("You put yourself back together and help " + girlname + " make herself presentable.");
            showneed();
            resetclothes();
            if (rstmoves === 1) {
                resetmoves();
            }
            poploc();
            c(locstack[0], "Continue... ");
        } else if (locstack[0] === "thebeach") {
            s("You and " + girlname + " dust yourselves off and hike back up to the road.");
            showneed();
            poploc();
            c(locstack[0], "Continue... ");
        } else if (locstack[0] === "photogame") {
            if (photolevel === 3) {
                if (bladder > blademer)
                    s("Desperate to get to a restroom, but also somewhat shy,");
                s(girlname + " quickly puts her clothes back on and hops off the stage.");
            } else if (photolevel === 3) {
                if (bladder > blademer)
                    s("Desperate to get to a restroom, but also running somewhat on autopilot,");
                s(girlname + " quickly changes back into her clothes and hops off the stage.");
            } else {
                s(girlname + " hops down off the stage.");
            }
            showneed();
            poploc();
            c("indepee", "Continue... ");
        } else if (locstack[0] === "dodance") {
            s("You pull " + girlname + " off the dancefloor.");
            showneed();
            poploc();
            c(locstack[0], "Continue... ");
        } else if (locstack[0] === "thewalk") {
            s("You take " + girlname + "'s hand and hoof it quickly back to your parked car.");
            showneed();
            poploc();
            c(locstack[0], "Continue... ");
        } else if (locstack[0] === "theyard") {
            s("You stealthily creep back out of the gate, with " + girlname + " in tow.");
            showneed();
            poploc();
            c(locstack[0], "Continue... ");
        } else if (locstack[0] === "ptogether") {
            s("You quickly compose yourselves and head back out to the club, but first...");
            poploc();
            kissher();
        } else if (locstack[0] === "pgirlsroom") {
            s("You quickly compose yourselves guiltily sneak back out of the ladies room, but first...");
            poploc();
            kissher();
        } else if (locstack[0] === "pnorestroom") {
            s(girlname + " sighs in relief, and seems very aroused.");
            s(girltalk + "I feel <i>so</i> naughty!");
            poploc();
            kissher();
        } else if (locstack[0] === "postgame" || locstack[0] === "postgamelose") {
            if (notdesperate) {
            s("She smiles at you as she moves back to her own chair.");
            poploc();
            c(locstack[0], "Continue...");
            } else if(notydesperate){
                //TODO move back to her own chair
                s("When she finally emerges from the bathroom she sits down in your lap.");
                s("She kissed you soundly, before whispering in your ear: <strong>I feel <i>so</i> naughty!</strong>");
                poploc();
                attraction += 5;
                shyness -= 7;
                c(locstack[0], "Continue...");
            } else if(nothdesperate){
                //TODO probably have a shyness/attraction check
                s("You dash towards the urinal, already pulling your dick out of your boxers.");
                s("You don't bother holding back a moan as your bladder finally empties.");
                if(locstack[0]==="postgame") s("<em>Yes, you won the game. But it had been a close one.</em>");
                s("Suddenly the door to the men's room opens.");
                s("Surprised you turn your head to see " + girlname + " entering the room with a sultry smile");
                s("She moves over towards you and you can't help but jump a little as she grasps your still peeing dick");
                s("She captures your lips before whispering: <strong>That was really hot!</strong>");
                poploc();
                attraction += 10;
                shyness -= 10;
                c(locstack[0], "Continue...");
            }
            else{
                s("You emerge from the restroom first, then " + girlname + " comes back, looking a little damp and very aroused.");
                s(girltalk + "I feel <i>so</i> naughty!");
                poploc();
                kissher();
            }
        } else if (locstack[0] === "thehottub") {
            s("You take " + girlname + "'s hand and help her out of the hot tub, admiring the view in the dim starlight.");
            s("You can't help staring as she dries off as best she can and dresses beside you in the warm evening air.");
            showneed();
            poploc();
            c(locstack[0], "Continue... ");
        } else if (locstack[0] === "tubsex") {
            s("You both sit there for a few seconds, trying to catch your breath.");
            resetclothes();
            if (rstmoves === 1) resetmoves();
            poploc();
            c(locstack[0], "Continue...");
        } else {
            poploc();
            eval(locstack[0] + "()");
        }

    }

    /*

  -----------------------------------------------------------------

  Common Tasks

  Commonly used functions for common situations.

  -----------------------------------------------------------------

*/


    /*
//TODO update comments
  Location handling.
    curloc is ALWAYS the current location, but...
       curloc is ONLY set under certain circumstances:
         1)  Leaving car to go to a destination _and_ the
	     destination is not a repeat and still open.
	 2)  Special locations such as the dancefloor.

    nextloc is the INTENDED destination.  Meaning you set it
       when you choose to head somewhere.

*/
    //TODO probably delete these functions
    function pushloc(newloc) {
        if (newloc !== locstack[0]) {
            locstack.unshift(newloc);
        }
    }

    function poploc() {
        if (locstack[0] !== locstack[1]) {
            locstack.shift();
        }
    }

    function champagnenow() {
        if (champagnecounter > 5) {
            s("Sadly, the bottle of champagne is empty.");
        } else {
            s("You suggest having some champagne.");
            if (champagnecounter === 0) {
                s("She smiles and goes into the kitchen to get some glasses.");
            }
            displayneed();
            if (bladder < blademer) {
                s(fillchampok[randcounter]);
                champagnecounter++;
                s("You toast and enjoy the champagne together.");
            } else if (bladder < bladlose) {
                s(girltalk + wonderwhy[randcounter]);
                incrandom();
                displaygottavoc();
                s(fillchamp[randcounter]);
                incrandom();
                champagnecounter++;
                s("She drinks the champagne with you after a hurried toast.");
            } else {
                s(girltalk + cantdo[randcounter]);
                incrandom();
                s(girltalk + "I can't even <i>think</i> about champagne");
                displaygottavoc();
                s(fillchampbad[randcounter]);
                incrandom();
                champagnecounter = 6;
                s("She tosses back the champagne quickly, dropping the glass onto the floor.");
            }
            tummy += 50;
            yourtummy += 50;
        }
        c(locstack[0], "Continue...");
    }

    function comforther() {
        s("You walk to her and hold her as she cries.");
        s("<b>YOU:</b> I'm so sorry.  You're really a beautiful, sexy girl.");
        s("She stops crying and seems a little happier.");
        c(locstack[0], "Continue ... ");
    }

    function giveroses() {
        if (bladder < blademer) {
            s(girltalk + "Thanks! They're beautiful.");
            attraction += 7;
        } else {
            s(girltalk + "Thanks for the flowers, but I've really got to go.");
            s("She takes the roses and holds them against her belly.");
            attraction += 2;
            waitcounter += 2;
        }
        roses -= 1;
        c(locstack[0], "Continue...");
    }

    /*

  -----------------------------------------------------------------

  STORY PARTS

  Separate parts of the story, in more or less order.

  -----------------------------------------------------------------

*/


    //TODO no pay and move on if you have no money
    function buydrink() {
        if (money >= 9) {
            s(bargirldesc[randcounter]);
            incrandom();
            s("You buy a cocktail for $9.00.");
            cocktail += 1;
            money -= 9;
            s("<b>BARTENDER:</b> " + bargirlquotes[randcounter]);
            incrandom();
        } else s("You don't have enough money!");
        c("flirtbargirl", "Flirt with the bar girl.");
        c("buydrink", "Buy another one.");
        if (money >= 9) c(locstack[0], "Pay and move on...");
        else c(locstack[0], "Continue...");
    }

    function flirtbargirl() {
        s("<b>YOU:</b>" + bargirlflirt[randcounter]);
        s(bargirldesc[randcounter]);
        s("<b>BARTENDER:</b> " + bargirlresp[randcounter]);
        incrandom();
        s(girlname + " seems to be glaring at you.");
        externalflirt++;
        c(locstack[0], "Continue...");
    }

    function buysoda() {
        if (money >= 5) {
            s("You buy a soda for $5.00.");
            soda += 1;
            money -= 5;
        } else s("You don't have enough money!");
        c("buysoda", "Buy another soda" )
        c(locstack[0], "Continue...");
    }

    function stealsoda() {
        s("You climb behind the snack counter, grab a big paper cup.  You scoop a bit of ice and fill it to the top, capping it with a lid and a straw.");
        soda += 1;
        c("stealsoda2", "Steal another soda.")
        c(locstack[0], "Continue...");
    }

    //TODO put a limit on this/ Game update
    //TODO randomize quotes
    function stealsoda2(){
        s("You grab another paper cup, and fill it up in a similar way as the previous one.");
        soda += 1;
        c("stealsoda2", "Steal another soda.");
        c(locstack[0], "Continue...");
    }


    function breakclub() {
        s("You try the door with your key...");
        if (bladder > blademer) {
            s(girltalk + sayhero[randcounter]);
            attraction += 3;
        }
        displayneed();
        displayyourneed();
        c("darkclub", "Continue...");
    }

    function reclub() {
        clubkey = 0;
        pushloc("theclub");
        theclub();
    }

    function darkclub() {
        if (locstack[0] !== "darkclub") {
            s("You and " + girlname + " enter the nightclub.  It's dark, silent and deserted.");
            pushloc("darkclub");
        } else {
            s("You are with " + girlname + " in the closed nightclub.");
        }

        showneed();
        displayyourneed();
        if (bladder > bladlose) wetherself();
        else if (yourbladder > yourbladlose) wetyourself();
        else if (gottagoflag > 0) preventpee();
        else {
            standobjs();
            if (!checkedherout) c("checkherout", "Check her out.");
            c("youpee", "Go to the bathroom.");
            c("leavehm", "Leave the club.");
        }
    }


    function theclub() {
        if (beenclub && locstack[0] === "driveout" && thetime < clubclosingtime) {
            s(girlname + " giggles: But we've already been to the club, silly!");
            if (clubkey > 0)
                c("reclub", "But I found this key I have to return!");
            c(locstack[0], "Continue...");
        } else {
            if ((thetime < clubclosingtime) || locstack[0] === "theclub") {
                if (locstack[0] !== "theclub" && locstack[0] !== "dodance") {
                    s("You and " + girlname + " enter the Night Club.");
                    pushloc("theclub");
                } else {
                    s("You are with " + girlname + " in the Night Club.");
                    if (randomchoice(3)) noteholding();
                    else if (randomchoice(5)) interpbladder();
                }

                beenclub = 1;
                showneed();
                displayyourneed();
                if (bladder > bladlose) wetherself();
                else if (yourbladder > yourbladlose) wetyourself();
                else {
                    if (gottagoflag > 0) {
                        preventpee();
                    } else {
                        c("buydrink", "Buy a drink.");
                        c("godance", "Ask her to dance.");
                        if (clubkey < 1) c("lookaround", "Look around.");
                        standobjs();
                        if (yourbladder > yourbladurge)
                            c("youpee", "Go to the bathroom");
                    }
                    c("leavehm", "Leave the club.");
                }
            } else itsclosed("theclub");
        }
    }

    function godance() {
        pushloc("dodance");
        changevenueflag = 1;
        showneed();
        displayyourneed();
        if (gottagoflag > 0) {
            c("holdit", "Ask her to hold it.");
            c("allowpee", "Let her go.");
        } else {
            s(girltalk + "Okay.  Let's dance.");
            s("You head out to the dancefloor to cut up the rug.");
            c(locstack[0], "Continue...");
        }
    }

    function dodance() {
        pushloc("dodance");
        s("You are dancing with " + girlname + " in your arms.");
        showneed();
        displayyourneed();
        if (randomchoice(3)) noteholding();
        else if (randomchoice(5)) interpbladder();

        if (bladder > bladlose) wetherself();
        else if (yourbladder > yourbladlose) wetyourself();
        else {
            if (gottagoflag > 0) {
                preventpee();
            } else {
                c(locstack[0], "Keep Dancing.");
                c("kissher", "Kiss her.");
                c("feelup", "Feel her up.");
                standobjs();
                if (yourbladder > yourbladurge)
                    c("youpee", "Go to the bathroom.");
            }
            c("goback", "Leave the dancefloor.");
        }
    }


    function pgirlsroom() {
        if (locstack[0] === "pgirlsroom") {
            poploc();
            eval(locstack[0] + "()");
        } else {
            pushloc("pgirlsroom");
            s("<b>YOU:</b> Can I watch?  It would be <u>so</u> sexy!");
            if (attraction >= pwatchthreshold) {
                displayneed();
                s(girltalk + "Really?  Well.... okay.  I guess there's nobody around.");
                s("She grabs you by the hand and heads for the ladies room.");
                displayneed();
                c("pgirlsroom2", "Follow her...");
                c("indepee", "Change your mind...");
            } else {
                s(girltalk + "I don't think so, buddy.");
                indepee();
            }
        }
    }

    function pgirlsroom2() {
        s("She looks right, looks left, and peeks in the door before quickly pulling you into a very cramped stall.");
        if (bladder < bladlose - 10) bladder = bladlose - 10;
        displayneed();
        s("The sight of the toilet seems to have increased her urgency.");
        c("ptogether3", "Continue...");
    }

    //TODO let her choose.
    function pnorestroom() {
        if (locstack[0] === "pnorestroom") {
            poploc();
            eval(locstack[0] + "()");
        } else {
            pushloc("pnorestroom");
            s("<b>YOU:</b> Why don't you go ahead and go.  But not in the restrooms.");
            if (attraction >= pnorestroomthreshold) {
                displayneed();
                s(girltalk + "What?  Then where am I supposed to go?");
                displayneed();
                c("ptrashcan", "Tell her to pee in the trash can.");
                c("psink", "Tell her to pee in the snack counter sink.");
                c("psodacup", "Tell her to pee in a soda cup.");
                c("pfloor", "Tell her to go on the floor.");
                c("indepee", "Change your mind...");
            } else {
                s(girltalk + "No way, dude.  I'm outta here.");
                indepee();
            }
        }
    }

    function ptrashcan() {
        s("<b>YOU:</b> How about that trashcan?");
        displayneed();
        s(girlname + " looks around apprehensively before heading over to it.");
        s(girltalk + "Am I gonna regret this?");
        if (pantycolor === "none")
            s(peeprepquotebare);
        else
            s(peeprepquote);
        s("Quickly, " + girlname + " lowers herself over the trashcan and lets go.  Her pee hisses out and hits the trashcan liner with a loud clatter.");
        flushdrank();
        sawherpee = 1;
        s("The bottom of the trashcan is a sea of fragrant pee.  You offer her a tissue, but she simply gets back up and gives you a hug.");
        s(girltalk + "That's <u>so</u> much better.");
        c("goback", "Continue...");
    }

    function psink() {
        s("<b>YOU:</b> How about the sink over there?");
        displayneed();
        s(girlname + " looks around apprehensively before climbing over the snack counter.");
        s(girltalk + "How am I gonna do this?");
        if (pantycolor === "none")
            s(peeprepquotebare);
        else
            s(peeprepquote);
        s("Carefully, " + girlname + " lifts herself up onto the counter and positions her butt over the sink.  Even before she's settled into place, she lets go.  Her pee hisses out and hits the metal sink with a loud clatter.");
        flushdrank();
        sawherpee = 1;
        c("goback", "Continue...");
    }

    function psodacup() {
        s("<b>YOU:</b> How about a soda cup?");
        displayneed();
        s(girlname + " looks around apprehensively as you get a big plastic soda cup from behind the snack counter.");
        s(girltalk + "Am I gonna regret this?");
        if (pantycolor === "none")
            s(peeprepquotebare);
        else
            s(peeprepquote);
        s("Carefully, " + girlname + " brings the cup between her beautiful trembling thighs and lets go.  Her pee hisses out and foams into the cup.");
        flushdrank();
        sawherpee = 1;
        s(girltalk + "That's better!");
        s("She puts a lid on the cup and hands it to you.  The cup is warm with the heat of her urine, and her scent wafts from the straw hole.");
        c("goback", "Continue...");
    }

    function pfloor() {
        s("<b>YOU:</b> Why don't you pee right there on the carpet?");
        displayneed();
        s(girlname + " looks around apprehensively before squatting down.");
        s(girltalk + "Are you sure we're not gonna get in trouble?");
        if (pantycolor === "none")
            s(peeprepquotebare);
        else
            s(peeprepquote);
        s(girlname + " starts to pee immediately.  Her stream hisses out and spatters on the carpet, which soaks it up quickly, making a gurgling spattering noise.  The scent of her pee fills the air.");
        flushdrank();
        sawherpee = 1;
        c("goback", "Continue...");
    }

    function pphotogame() {
        s("<b>YOU:</b> I know you really need to go, but can I take just a couple snapshots first?");
        displayneed();
        s(girltalk + "What <u>kind</u> of pictures?");
        c("photogame2", "Just a couple snapshots of you up on the stage there.");
        c("photogame2c", "How about a few costume pics?");
        c("photogame2n", "Well - nobody's around, so I'd really love it if you would do a few nudes.");
    }

    function photogame2() {
        if (attraction >= photogamethreshold) {
            displayneed();
            s(girltalk + "Okay.  But can I please go pee first?");
            displayneed();
            photolevel = 0;
            c("photogame", "I'd really like it if you'd wait...");
            c("indepee", "Alright - go ahead and pee.");
        } else {
            s(girltalk + "No way, dude.  I'm outta here.");
            indepee();
        }
    }

    function photogame2c() {
        if (attraction >= photogamecthreshold) {
            displayneed();
            s(girltalk + "Well, okay.  It would be neat to play dressup.  But can I please go pee first?");
            displayneed();
            photolevel = 1;
            c("photogame", "I'd really like it if you'd wait...");
            c("indepee", "Alright - go ahead and pee first.");
        } else {
            s(girltalk + "No way, dude.  I'm outta here.");
            indepee();
        }
    }

    function photogame2n() {
        if (attraction >= photogamenthreshold) {
            displayneed();
            s(girltalk + "That's naughty.  Very naughty.  But can I please go pee first?");
            displayneed();
            photolevel = 2;
            c("photogame", "I'd really like it if you'd wait...");
            c("indepee", "Alright - go ahead and pee first.");
        } else {
            s(girltalk + "No way, dude.  I'm outta here.");
            indepee();
        }
    }

    //TODO show your need
    //TODO fix wetherself when naked
    //TODO not running to the bathroom if she wet herself
    function photogame() {
        if (locstack[0] !== "photogame") {
            pushloc("photogame");
            displayholdquip();
            posectr = 0;
            askholditcounter++;
            s("<b>YOU:</b> Thanks.  You're very sexy.");
            s("You motion " + girlname + " up onto the nightclub stage.");
            s("She carefully ascends the stairs, and you find a switch that turns on some stage lights.");
        } else {
            s("You're taking snapshots of " + girlname + " up on the nightclub stage.");
            if (photolevel === 3) s("She's completely nude.");
            if (photolevel === 1) s("She's wearing " + poseoutfit[outfitctr] + ".");
            if (bladder > blademer) {
                interpbladder();
                noteholding();
            }
        }
        showneed();
        if (bladder > bladlose) wetherself();
        else if (yourbladder > yourbladlose) wetyourself();
        else {
            if (posectr <= posemax) c("photopose", "Ask her to pose.");
            if (photolevel === 1 && outfitctr < outfitmax) c("photochange", "Ask her to change.");
            if (photolevel === 2) c("photonude", "Ask her to disrobe.");
            c("goback", "Photo session is over...");
        }
    }

    function photopose() {
        s("<b>YOU:</b> How about striking a pose?");
        if (photolevel === 3)
            s(girlname + " " + posenude[posectr]);
        else
            s(girlname + " " + posenorm[posectr]);
        posectr++;
        if (bladder > blademer) {
            s(poseemer[randcounter]);
            incrandom();
        }
        c(locstack[0], "Take a photo...");
    }

    function photochange() {
        s("<b>YOU:</b> How about changing into a costume?");
        if (bladder > blademer) {
            s(girlname + " is almost doubled over as she takes little baby steps back to the closet and returns with a " + poseoutfit[outfitctr]);
            s(donemer[outfitctr]);
        } else {
            s(girlname + " walks back to the closet and returns with a" + poseoutfit[outfitctr]);
            s(donoutfit[outfitctr]);
        }
        outfitctr++;
        c(locstack[0], "Continue...");
    }

    function photonude() {
        s("<b>YOU:</b> Okay - so you can take off your clothes.");
        if (bladder > blademer) {
            s(girlname + undressquoteemer);
            s("<i>You can see her face filled with a look of concentration as she waits for an opportune moment to continue.</i>");
            s("She then shyly unclasps her bra, revealing her breasts briefly before turning her back to you.  Her thighs are rubbing together.");
            if (pantycolor === "none") {
                s("She quickly crosses her legs and squeezes tightly - she was not wearing any panties.");
            } else {
                s("She hesitates and looks to you for confirmation before spreading her legs slightly, giving her pussy a firm press, and quickly slipping her panties off then tightly crossing her legs.");
            }
        } else {
            s(girlname + undressquote);
            if (pantycolor === "none") {
                s("She's not wearing any panties.");
            } else {
                s("She hesitates and looks to you for confirmation before slipping her panties off and placing them on the floor next to her.");
            }
        }
        s("She's standing on stage completely nude.");
        incrandom();
        photolevel = 3;
        c(locstack[0], "Continue...");
    }





    //TODO option for you to pee as well
    function ptogether() {
        if (locstack[0] === "ptogether") {
            poploc();
            eval(locstack[0] + "()");
        } else {
            pushloc("ptogether");
            s("<b>YOU:</b> Don't go and leave me alone!");
            if (attraction >= ptogetherthreshold) {
                displayneed();
                s(girltalk + "Really?  You want to come with me?");
                s("She grabs you by the hand and heads for the back of the club.");
                displayneed();
                c("ptogether2", "Follow her...");
                c("indepee", "Change your mind...");
            } else {
                s(girltalk + "You're a big boy.  You can take care of yourself.");
                indepee();
            }
        }
    }

    //TODO option to make out
    function ptogether2() {
        s(girlname + " leads you back to the restrooms.");

        if (!randomchoice(rrlockedthresh)) {
            s("She looks right, looks left, and peeks in the door before quickly pulling you into a very cramped stall.");
            if (bladder < bladlose - 10) bladder = bladlose - 10;
            displayneed();
            s("The sight of the toilet seems to have increased her urgency.");
            c("ptogether3", "Continue...");
        } else {
            s("There's a long line for the womens restrooms.  You notice they're mostly young, dressed to the nines, and in various stages of extreme urinary urgency.  Your daydreams are interrupted quickly.");
            s(girlname + " squeezes your hand: I can't hold it!  What are we gonna do?");
            c("ptogether4", "Invite her into the mens room.");
            c("ptogether5", "Take her out the nearby back door.");
            c("ptogether6", "Stand around looking dumb.");
        }
    }

    function ptogether3() {
        if (pantycolor !== "none")
            s(girlname + ptogetherquote);
        else
            s(girlname + ptogetherquotebare);
        s("You try not to stare too much as the torrent cascades from between her thighs.  You hear the violent hissing and splashing of her pee, and the scent fills the tiny cubicle.  You want to touch her so badly.");
        flushdrank();
        sawherpee = 1;
        c("ptogether3d", "Feel the stream.");
        c("ptogether3c", "Kiss her thighs.");
        c("ptogether3b", "You're too shy.");
    }

    function ptogether3b() {
        s("As the torrent subsides, you offer her some tissue.");
        s(girltalk + "Thanks - I've never had to go so bad in my life!");
        s("<i>She seems relaxed, radiant ... and aroused.</i>");
        c("goback", "Continue...");
    }

    function ptogether3c() {
        s("You lay your head in her lap, the warmth of her thighs on your cheek.");
        s("The hissing is louder down there, and you feel the small droplets of her pee spray landing on your upper lips.");
        s("You can sense the heat from the stream, and the smell of her is overpowering.");
        c("ptogether3b", "Continue...");
    }

    function ptogether3d() {
        s("You caress her, running your hand down her back and along the line of her butt crack.");
        s("Her crack is warm and soft, and as your fingers reach the edge of her pussy lips, you feel small droplets from the urine stream wetting your hand.");
        s("You carefully put just one finger into the edge of her stream - it feels hot and wet.");
        c("ptogether3b", "Continue...");
    }


    // You take her into the mens room
    function ptogether4() {
        s("<b>YOU:</b> Quick!  In here!");
        s("You pull her across the hall towards the men's room.");
        s(girltalk + "But I can't go in there!");
        c("ptogether4b", "I'm a guy, and I'm giving you permission!");
        c(locstack[0], "Okay, then I guess you'll just have to hold it.");
    }

    function ptogether4b() {
        s("She follows you into the mens room, and you carefully avoid any eye contact with the two dudes using the urinals.");
        displayneed();
        s("You find a reasonably clean stall and pull her in with you.");
        c("ptogether3", "Continue...");
    }

    // You take her out back
    function ptogether5() {
        s("<b>YOU:</b> Quick!  In here!");
        s("You pull her towards the back door at the end of the hall.");
        s(girltalk + "Where are we going?");
        s("<b>YOU:</b> I know a place!");
        displayneed();
        s("You emerge together into a poorly lit parking lot.");
        c("ptogether5a", "Tell " + girlname + " to pee behind the dumpster.");
        c("ptogether5b", "Tell " + girlname + " you'll help her.");
    }

    function ptogether5a() {
        s("<b>YOU:</b>  You can go behind that dumpster over there!");
        s(girltalk + "<b>This</b> is your solution???");
        displayneed();
        s("You can see the struggle in her eyes as she makes up her mind what to do.");
        s(girltalk + "Can you hold me so I don't fall over?");
        c("ptogether5a2", "Okay...");
        c(locstack[0], "Nevermind - let's go back inside.");
    }

    function ptogether5a2() {
        s("You don't have to be asked twice.");
        s("You take her hand and lead her behind the dumpster.  She seems nervous.");
        displayneed();
        if (pantycolor !== "none") s(ptogetheroutquote);
        else s(ptogetheroutquotebare);
        s("You steady her and the stream starts immediately, first as an incoherent spray which slightly wets her shoes, and quickly building into a powerful stream.");
        s("By the time she finally cuts it off, the pee has pooled into a pond which is seeping under the dumpster.");
        if (pantycolor !== "none")
            s(finishtogethroutquote);
        else
            s(finishtogetheroutquotebare);
        flushdrank();
        sawherpee = 1;
        c("goback", "Continue...");
    }

    function ptogether5b() {
        s("<b>YOU:</b>  Here!  I'll help you.");
        s("You push her up against the wall, in the shadows a little ways from the door.");
        s(girltalk + "I can't...");
        if (pantycolor !== "none") {
            s(ptogetherdumpquote);
            s("Her pussy is warm and pulsing underneath the thin fabric as she struggles to control her bladder.");
            s("You pull the gusset aside and spread her lips with your fingers.");
        } else {
            s(ptogetherdumpquotebare);
            s("Her pussy is warm and pulsing aginst your hand as she struggles to control her bladder.");
            s("You carefully spread her lips between your fingers.");
        }
        c("ptogether5c", "Continue...");
    }

    function ptogether5c() {
        s("<b>YOU:</b>  Go.  Let it all out.");
        s("She protests, but not too strongly, and you feel her pussy tense just as the flow starts, running between your fingers and slightly wetting them before spattering onto the ground in front.");
        if (pantycolor !== "none")
            s(finishtogetherdumpquote);
        else
            s(finishtogetherdumpquotebare);
        s("She gives you a long, hard kiss before you head back inside together.");
        flushdrank();
        sawherpee = 1;
        c("goback", "Continue...");
    }

    // You stand around looking dumb.
    function ptogether6() {
        s("<b>YOU:</b> Duhhhhh...");
        displayneed();
        s("She stamps her foot in impatience.");
        s(girltalk + "You're no help!");
        s("You head back to the dance floor together.");
        c(locstack[0], "Continue...");
    }



    //TODO put flag in proper place
    let floorcounter = 0;
    function theelevator() {
        if (locstack[0] !== "theelevator") {
            pushloc("theelevator");
            s("You take " + girlname + " by the hand and go to wait in front of the elevator.");
            displayneed();
            displayyourneed();
            //TODO put flag in proper place
            elevatorwaitcounter = 0;
            c(locstack[0], "Continue...");
        } else {
            if (floorcounter === 0) {
                if (randomchoice(3)) {
                    if (elevatorwaitcounter > 2 && bladder > blademer) {
                        s("The elevator finally appears, and " + girlname + " rushes to enter as the door opens.  She suddenly steps back and stands still, trembling with the effort to conceal her desperation, as a pretty woman walks out.");
                        s(girlname + " lunges into the elevator and mashes the 3rd floor button with one hand while openly holding herself with the other.");
                    } else {
                        s("The elevator appears, so you step inside with " + girlname + " and hit the button for the 3rd floor.");
                    }
                } else {
                    s("The elevator has not yet arrived.");
                    s("You wait patiently with " + girlname + ".");
                    floorcounter = -1;
                    elevatorwaitcounter++;
                }
            } else if (floorcounter === 3) {
                s("The elevator finally reaches the 3rd floor.");
                s("You and " + girlname + " walk across the hall to the door of her apartment.");
                if (bladder > blademer && !herkeys)
                    s(girltalk + "Good thing I haven't lost my keys, huh?");
            } else {
                s("You're in the elevator with " + girlname + ".");
                noteholding();
            }
            showneed();
            if (floorcounter >= 3) {
                poploc();
            } else {
                floorcounter += 1;
            }
            if (bladder > bladlose) wetherself();
            else if (yourbladder > yourbladlose) wetyourself();
            else c(locstack[0], "Continue...");
        }
    }

    function givekeys() {
        herkeys = 0;
        s("You pull her keys from your pocket.");
        if (bladder >= blademer) {
            displayneed();
            s(girlname + " grabs the keys and opens the door.");
            c(locstack[0], "Continue...");
        } else {
            s(girltalk + " Where'd you get those?");
            c("keynevermind", "Ummm.....");
            c("keynevermind", "Errr.....");
            c("keynevermind", "Duhhh....");
        }
    }

    function keynevermind() {
        s(girltalk + " Oh, never mind.  Want to come in?");
        s("She opens the door.");
        c(locstack[0], "Continue...");
    }

    function lookforkeys() {
        s(girlname + " offers you her purse.");
        showneed();
        s("You palm the keys in your pocket, take her purse and rummage through it.");
        herkeys = 0;
        c("lookforkeys", "Haven't found anything yet.");
        c(locstack[0], "Found them!");
    }

    //TODO offer beer
    function thehome() {
        if (locstack[0] !== "thehome") {
            kisscounter = 0;
            feelcounter = 0;
            pushloc("thehome");
            s("You and " + girlname + " arrive at her place.");
            s("It's a 3rd floor apartment in a nice complex.");

            if (attraction > 100 && (beenbar || seenmovie) && beenclub && beenmakeout) {
                showneed();
                displayyourneed();
                s("She invites you to come up for a drink...");
                c("theelevator", "Go up with her.");
                c("gameover", "Say goodnight.");
            } else {
                s(girltalk + "Good Night...  see you soon?");
                locstack[0] = "gameover";
                c("gameover", "Continue...");
            }
        } else if (herkeys) {
            s(girlname + " searches through her purse for her keys.");
            displayneed();
            voccurse();
            s(girltalk + "I can't find my keys!");
            showneed();
            displayyourneed();
            c("givekeys", "Offer her her keys.");
            c("lookforkeys", "Offer to look for her keys.");
        } else {
            s("You are with " + girlname + " at her home.");

            if (kisscounter > maxkiss) {
                s(girlname + " suddenly pulls away from you and sits straight up.");
                s(girltalk + "You know, this just isn't working out.");
                s(girltalk + "I'm afraid we're going to have to call it a night.");
                c("gameover", "Continue...");
            } else {
                displaygottavoc();
                displayneed();
                displayyourneed();
                //TODO figure out what the hell this is
                if (champagnecounter > 5) {
                    if (bladder > bladlose)
                        s(girlname + " gasps: I'm going ... bathroom");
                    else
                        s("She invites you to come back to her bedroom.");
                    c("thebedroom", "Follow her closely to her bedroom.");
                    c("gameover", "Say goodnight.");
                } else {
                    if (gottagoflag) {
                        c("allowpee", "Tell her she should go and pee.");
                    }
                    c("youpee", "Ask if you can use her bathroom.");
                    c("kissher", "Kiss her on the lips.");
                    if (champagne > 0) {
                        c("champagnenow", "Offer her champagne.");
                    }
                    if (soda > 0) {
                        c("sodanow", "Offer her soda.");
                    }
                    c("gameover", "Say goodnight.");
                }
            }
        }
    }

    function thebedroom() {
        pushloc("thebedroom");
        if (locstack[0] !== "thebedroom") {
            s("You follow her closely back to her bedroom.");
            locstack[0] = "thebedroom";
            if (bladder > bladlose)
                s("She presses her crotch into the bedpost.");
            else
                s("She looks at you romantically with a cute little smile.");
        } else {
            s("You are with " + girlname + " in her bedroom.");
        }
        showneed();
        displayyourneed();
        if (gottagoflag) {
            c("allowpee", "Tell her she can go and pee.");
        }
        if (gottagoflag) {
            c("holdit", "Ask her to hold it.");
        }
        c("thebed", "Kiss her.");
        c("gameover", "Say goodnight.");
    }

    //TODO something with your own desperation to pee
    function thebed() {
        if (locstack[0] !== "thebed") {
            kisscounter = 0;
            pushloc("thebed");
            arousal = 0;
            if (bladder > bladlose)
                s(girlname + " collapses on the bed, pulling you on top of her.");
            else
                s(girlname + " pulls you down onto the bed.");
        } else {
            s("You are in bed with " + girlname);
        }

        if (kisscounter > maxkiss) {
            s(girlname + " suddenly pulls away from you and sits up in bed.");
            s(girltalk + "You know, this just isn't working out.");
            s(girltalk + "I'm afraid we're going to have to call it a night.");
            c("gameover", "Continue...");
        } else {

            displayneed();
            displayyourneed();
            if (pantycolor === "none") xpanties = 1;

            if (arousal < 20) {
                s("She seems very aroused.");
            } else if (arousal < 40) {
                s("She seems very aroused.");
            } else if (arousal < 70) {
                s("She seems extremely aroused.");
            } else if (arousal < 100) {
                s("She seems unbelievably aroused.");
            } else if (arousal < 140) {
                s("She seems earthshatterinly aroused.");
            } else {
                s(girltalk + "<i>Hurry!</i> Fuck me <b>NOW</b>!");
            }

            s("What will it be?");

            c("kissher", "Kiss her on the mouth.");
            if (!tthigh && xskirt) c("touchthigh", "Touch her thigh");
            if (!tbreast && xtop) c("touchbreast", "Touch her breasts");
            if (!tass && xskirt) c("touchass", "Touch her ass");
            if (!tpussy && xskirt) c("touchpussy", "Touch her pussy");
            if (!kneck) c("kissneck", "Kiss her on the neck");
            if (!kbreast && xbra) c("kissbreast", "Kiss her on the nipple");
            if (!kthigh && xskirt) c("kissthigh", "Kiss her on the thigh");
            if (!kpussy && xskirt) c("kisspussy", "Kiss her on the pussy");
            if (!xskirt) c("toskirt", sextakeoffskirt);
            if (!xtop) c("totop", sextakeoffblouse);
            if (!xbra && xtop) c("tobra", "Take off her bra");
            if (!xpanties && xskirt) c("topanties", "Take off her panties");
            if (arousal >= 140 && xpanties && xskirt) c("fucknow", "Fuck her <b>NOW</b>.");
            else if (arousal > 120 && xpanties && xskirt) c("fucknow", "Fuck her");
            c("gameover", "Say goodnight.");
        }
    }

    function touchthigh() {
        if (!xskirt) {
            arousal += 6;
            s(sextouchthighquote);
            if (bladder > blademer) {
                s("They are wet and slippery.  You pull your hand back out and smell her sweat.  No pee yet, you think.");
            } else {
                s("She moans and quivers with delight.");
                s(girltalk + "That feels <i>so</i> good!");
            }

        } else {
            s("You slide your hand up her inner thighs.");
            if (bladder > blademer) {
                s("She suddenly clamps her legs together, trapping your fingers.");
                s("She squirms back and forth, trying to find a comfortable position, and pulling your arm around as she does it.");
                s(girltalk + "Oops.  I have to go sooooo bad I almost lost it for a second there.  Here's your arm back.");
            } else {
                s("She moans and quivers with delight.");
                s(girltalk + "That feels <i>so</i> good!");
            }
            arousal += 20;
        }
        if (multiplemoves === 0) {
            tthigh = 1;
        }
        c(locstack[0], "Continue...");
    }


    function touchbreast() {
        if (xtop === 0) {
            arousal += 4;
            s("You massage her breasts through the thin fabric of her blouse.");
        } else if (xbra === 0) {
            s("You rub her nipples through the silky lace of her bra.");
            arousal += 2;
        } else {
            arousal += 20;
            s("You twirl your finger around her erect nipples and she moans in pleasure.");
            if (bladder > bladlose) {
                s(girlname + " moans: Yes! Harder! I can't control it much longer.");
            } else {
                s("You didn't think it was possible, but her nipples are now even harder and sticking out even further.");
            }
        }
        if (multiplemoves === 0) {
            tbreast = 1;
        }
        c(locstack[0], "Continue...");
    }

    function touchass() {
        if (!xskirt) {
            arousal += 2;
            s(sextouchassquote);
            if (bladder > blademer && !xpanties) {
                s("Her butt cheeks are clenching and releasing, and the panties are pulled way into her crack.");
            } else {
                s("The silky cloth slides easily over her smooth cheeks and she presses into your hands.");
            }
        } else if (!xpanties) {
            arousal += 4;
            s("You rub her ass though the silky fabric of her panties.");
            if (bladder > blademer) {
                s("The panties are damp with her sweat.");
            } else {
                s("The thin cloth slides easily over her smooth cheeks and your fingers find their way underneath.");
            }
        } else {
            arousal += 10;
            s("You grab her ass and your fingers slide towards her hot cunt from the rear.");
            if (bladder > blademer) {
                s("Her butt clenches and your fingers seem stuck before they slide back out, lubricated by her sweat.");
            } else {
                s("She gasps: That's so <i>good</i>!");
            }
        }
        if (multiplemoves === 0) {
            tass = 1;
        }
        c(locstack[0], "Continue...");
    }

    function touchpussy() {
        if (xskirt === 0 && xpanties !== 0) {
            arousal += 4;
            s(sextouchpussyquote);
        } else if (xpanties === 0) {
            arousal += 12;
            s("You stroke her burning pussy though the silky wet fabric of her panties.");
            if (bladder > bladlose) {
                s("She grabs your hand and presses it into her crotch.  You can feel her pee hole as a tight quivering bump right under your index finger.");
                s(girltalk + "You have to help me hold it!");
            } else {
                s("She presses her cunt into your hand and reaches over to massage your dick.");
            }
        } else {
            arousal += 20;
            s("Your hand reaches up to firmly massage her dripping cunt as she moans in pleasure.");
            if (bladder > bladlose) {
                s("She grabs your hand and presses it more firmly into her crotch.  You can feel her pee hole as a tight quivering bump right under your index finger.");
                s(girltalk + "You have to help me hold it!");
            } else {
                s("You feel the bump of her erect clit pulsing beneath your fingers.");
            }
        }
        if (multiplemoves === 0) {
            tpussy = 1;
        }
        c(locstack[0], "Continue...");
    }

    function kissneck() {
        arousal += 4;
        s("You nibble delicately on her neck.");
        if (bladder > blademer) {
            s("Goosebumps suddenly form and her whole body shakes uncontrollable for a second.");
        } else {
            s("She seems to like it.");
        }
        if (multiplemoves === 0) {
            kneck = 1;
        }
        c(locstack[0], "Continue...");
    }

    function kissbreast() {
        if (!xtop) {
            arousal += 4;
            s("You bring your mouth up to her breasts and blow warm air through thin fabric of her blouse.  You can feel her nipples stiffen at the contact.");
        } else if (!xbra) {
            arousal += 10;
            s("You lick her nipples through the rough lace of her bra.");
        } else {
            arousal += 20;
            s("You suck and lick her stiff nipples and she moans in pleasure.");
            if (bladder > blademer) {
                s("They taste salty and sweet with her sweat.");
            }
        }
        if (multiplemoves === 0) {
            kbreast = 1;
        }
        c(locstack[0], "Continue...");
    }

    function kissthigh() {
        if (xskirt === 0) {
            arousal += 2;
            s(sexkissthighquote);
        } else {
            arousal += 10;
            s("You slide your cheek up her inner thighs, licking and kissing them passionately until you feel the heat of her pussy on your forhead.");
            if (bladder > blademer) {
                s("Her thighs are quivering with the effort keep her legs open and still clamp her pee hole shut.");
            }
        }
        if (multiplemoves === 0) {
            kthigh = 1;
        }
        c(locstack[0], "Continue...");
    }

    function kisspussy() {
        if (!xskirt) {
            s(sexkisspussyquote);
            if (bladder > blademer) {
                s("She groans and tries to push your head away");
            } else if (wetherpanties) {
                s("You smell the fragrance of her pee remaining from when she wet herself.");
            }
        } else if (!xpanties) {
            arousal += 8;
            s("You lay your face in her lap and tongue her pussy though the silky wet fabric of her panties.");
            if (bladder > bladlose) {
                s("She suddenly squeezes her legs together and pushes your head out.");
                s(girltalk + "Sorry!  I just had to do that.  I'm losing control!");
            } else {
                s("Your tongue finds her swollen clit through the thin cloth.");
                if (wetherpanties)
                    s("You smell the fragrance of her pee remaining from when she wet herself.");
            }
        } else {
            arousal += 20;
            s("You brush your lips over her fragrant pussy before burying your tongue in her dripping cunt.");
            if (bladder > blademer) {
                s("The quivering you feel through your tounge reminds you of the overfilled reservoir of pee that is barely controlled just inches away from your lips.");
            } else {
                if (wetherpanties)
                    s("You smell the fragrance of her pee remaining from when she wet herself.");
                s("It tastes of salt, and slightly sweet.  She gasps with sudden pleasure.");
            }
            if (bladder > bladlose) {
                s(girltalk + "Oh God! Oh God! Stop stop stop stop.");
                s("She suddenly slams her thighs together and pushes your head out.");
                s(girltalk + "Sorry sorry sorry.  I almost let a squirt out.  I'm <i>so</i> full!");
            }
        }
        if (multiplemoves === 0) {
            kpussy = 1;
        }
        c(locstack[0], "Continue...");
    }


    function totop() {
        arousal += 4;
        s("You slowly unbutton and remove her top, making sure to feel her up on the way past her breasts.  Her breasts are gorgeous and firm beneath the lace of her bra.");
        if (bladder > bladlose) {
            s(girltalk + "<i>HURRY</i> - I can't hold it much longer.");
            s("She looks like she's going to burst any second.");
        } else {
            s(girlname + " rubs her hands over your chest and begins to unbutton your shirt.");
        }
        xtop = 1;
        c(locstack[0], "Continue...");
    }

    function toskirt() {
        arousal += 4;
        if (bladder > blademer) {
            s(sextoskirtquoteemer);
        }
        if (!xpanties) {
            s(sextoskirtquote);
            if (bladder > blademer) {
                s("She momentarily catches her breath as a small bit of the pressure is reduced.")
            } else {
                s(girlname + " works at unzipping your pants, stroking your shaft through the cloth.");
            }
            if (bladder > bladlose) {
                s("The waistband is soaked with sweat from her exertions.");
            }
        } else {
            s(sextoskirtquotebare);
            if (bladder > bladlose) {
                s("It's spasmodically contracting as she fights to hold her pee.");
            } else {
                s(girlname + " unfastens your pants and pulls at your boxers, freeing your dick and stroking the shaft lightly.");
            }
        }
        xskirt = 1;
        c(locstack[0], "Continue...");
    }

    function tobra() {
        arousal += 4;
        if (xtop === 0) {
            s("You pull at her bra to very little effect.  Could it be she's still wearing her blouse?");
            if (bladder > bladlose) {
                s("UNGGGGHHHH! She grunts with the effort of holding it in.");
            } else {
                s(girltalk + "Having some technical difficulties?");
                s("She giggles.");
            }
        } else {
            s("You reach around behind her and find... that it's a front snap bra.  Problem is quickly solved ( good thinking! ) and you unsnap between her shapely round breasts.");
            if (bladder > bladlose) {
                s("Her chest is flushed, rising and falling quickly as she pants.");
            } else {
                s("She rips at your shirt and runs her cool hands all over your chest.");
            }
            xbra = 1;
        }
        c(locstack[0], "Continue...");
    }

    function topanties() {
        arousal += 4;
        if (!xskirt) {
            s(sextopantiesquote);
            if (bladder > bladlose) {
                s("She suddenly slams her legs together.");
                s(girltalk + "What are you doing? I'm nearly wetting myself!");
            }
        } else {
            if (bladder > bladlose)
                s("Her panties are stretched around the bulge of her unbelievably round and hard bladder.");
            s("You slip her damp panties down to reveal her curly pubes and moist warm pussy.");
            if (bladder > blademer) {
                s("It's spasmodically contracting as she fights to hold her pee.");
            } else {
                s(girlname + " pulls at your boxers, freeing your dick and stroking the shaft lightly.");
            }
            xpanties = 1;
        }
        c(locstack[0], "Continue...");
    }

    function resetclothes() {
        xpanties = 0;
        xbra = 0;
        xskirt = 0;
        xtop = 0
    }

    function resetmoves() {
        kneck = 0;
        kthigh = 0;
        kpussy = 0;
        kbreast = 0;
        tthigh = 0;
        tpussy = 0;
        tbreast = 0;
        tass = 0;
    }

    //TODO chance of failure upon pausing(still cuming)
    function fucknow() {
        fuckingnow = 1;
        s("You pull her on top of you and stick it into her soft, wet snatch.  It feels <i>so</i> good.");
        if (bladder > bladlose) {
            s("Her rock hard bladder rubs on your shaft through the thin wall of her vagina.");
        }
        if (bladder > blademer) {
            s("The spasms as she fights her impulse to pee combined with the thought that she's within seconds of wetting the bed with you inside her bring you to the edge.  You're about to cum!");
        } else {
            s("She moans with pleasure and you feel like you're about to cum already!");
        }
        c("fuckher2", "Keep fucking her");
        c("fuckher2b", "Pause for a second to regain control");
    }

    function fuckher2() {
        s("You keep pumping.");
        s("And you can't hold back.  You shoot your load and ram deep inside her.");
        if (bladder > blademer) {
            s("The sudden shock is too much for her and you feel the pee flowing from her cunt and filling the space above your shaft.");
            s("You relax just a little bit, and pee cascades onto the bed.");
            s("She's wet the bed.");
            c("wetbed", "Continue...");
        } else {
            bothcum();
        }
    }

    function prewet2() {
        s(girlname + " squeals: <b>NO!</b> <i>It's coming out!</i>");
        s("First a long squirt escapes from her throbbing pussy, and then another.");
        s("She collapses onto the bed as a thick stream cascades down to drench the sheets for almost a minute.");
        s("She lies there in relief ... not caring that much.");
        s("She's wet the bed.");
        c("wetbed", "Continue...");
    }

    function bothcum() {
        s("She arches her back and screams in ecstasy and collapses back onto the bed, breathing hard.");
        s("You both lie there in bed together, catching your breath.");
        if (bladder > bladneed)
            s("You cup her belly in your hand and feel a slight bulge, but " + girlname + " makes no move to get up right away.  You feel a slight regret that she wasn't absolutely desperate when she came.");
        else
            s("You run your hand over her tight belly, but you don't feel much of a bulge from her bladder.  She seems in no hurry to get up.  Sex without desperation is still sex.");
        c("gameover", "Continue...");
    }


    function wetbed() {
        flushdrank();
        s("You both lie there catching your breath.");
        s("The sheets are warm and soaked, her fragrance heavy in the air.");
        s(girltalk + "Well.... that was interesting.");
        c("gamewet", "Continue...");  // Wet the bed.
    }

    function fuckher2b() {
        s("You pull out for a second and regain a measure of control.");
        if (bladder > blademer) {
            s(girlname + " whispers: Hurry! It's coming out!!!");
            c("fuckher3", "Continue...");
        } else {
            s(girlname + " whispers in your ear: No! Don't stop.");
            c("fuckher3", "Continue...");
        }
    }

    function fuckher3() {
        if (bladder > blademer) {
            s("You thurst it back in, feeling the same unbearably stimulating combination of her struggle for control and the knowledge that she's on the edge of wetting the bed.");
            s(girltalk + "Please.  Stop.  It's <b>so</b> good, but I can't hold it anymore!");
            c("prewet2", "Keep fucking her");
            c("fuckher4", "Pause for a second");
        } else {
            s("You thurst it back in, feeling the her tight, wet pussy close around your shaft, and holding her heaving chest in your arms.");
            s("She starts moaning with each stroke: oh! oh! ungh! fuck! I'm going to cummmm!");
            c("bothcum", "Keep going.");
            c("fuckher2b", "Pause for a second");
        }
    }

    function fuckher4() {
        pushloc("fuckher6");
        s("You pause for a second.");
        if (bladder < bladsexlose)
            c("fuckher5", "Tell her: \"But it will be so much better if you just hold it another minute.\"");
        else
            c("fuckher5b", "Tell her: \"But it will be so much better if you just hold it another minute.\"");
        c("fuckher5b", "Tell her: \"You can hold on for just another minute - I know you can.\"");
        c("allowpee", "Stop and let her pee.");
        c("prewet2", "Keep going");
    }

    function fuckher5() {
        s(girlname + " takes a deep breath, and you hear her quitely counting to 3 as a calm takes over her body.");
        s(girltalk + "That would be more fun, wouldn't it?");
        s(girltalk + "Okay.  I'm going to try.");
        s(girltalk + "But promise you won't be mad if I can't hold it.");
        c("fuckher6", "I promise...");
    }

    function fuckher5b() {
        s(girlname + " takes a deep breath.  Then she gasps.");
        prewet2();
    }

    function fuckher6() {
        if (bladder < bladneed) {
            fuckher6b()
        } else {
            s(girlname + " pulls you back into her like a possessed woman and you start pumping quickly.");
            s("She's moaning and bucking her hips in seconds - and you can feel yourself on the verge of shooting your load.");
            if (bladder < bladcumlose)
                s("Suddenly " + girlname + " cries out and you feel her pussy grip your shaft hard.  You can't hold out one second longer.  Her orgasmic spasms are massaging your penis, she's fighting an overwhelming impulse to pee just for you, and she's absolutely the sexiest thing you've ever seen in the throes of her ecstasy.");
            else
                s("Suddenly " + girlname + " cries out and you feel her pussy grip your shaft hard.  She momentarily loses control and a hot jet of pee squirts out.<br>You can't hold out one second longer.  Her orgasmic spasms are massaging your penis, she's fighting an overwhelming impulse to pee just for you, and she's absolutely the sexiest thing you've ever seen in the throes of her ecstasy.");
            s("It's over.");
            s("You both lie there for about 20 seconds as you catch your breath and the contractions subside.");
            if (bladder >= bladcumlose)
                s("You feel the spurt of pee she released slowly trickle down and form a wet spot on the bed.");

            c("fuckher7", "Continue");
        }
    }

    function fuckher6b() {
        s(girlname + " smiles seductively at you as she slowly climbs back on the bed.");
        s("She wastes no time with climbing back on top of you and you quickly push your dick in again.");
        s("She's moaning and bucking her hips in seconds - and you can feel yourself on the verge of shooting your load.");
        s("Suddenly " + girlname + " cries out and you feel her pussy grip your shaft hard. You can't hold out one second longer. Her orgasmic spasms are massaging your penis, and she's absolutely the sexiest thing you've ever seen in the throas of her ecstasy.");
        s("You both lie there in bed together, catching your breath.");
        s("You run your hand over her tight belly, maybe you should've let her hold it after all.");
        s("Maybe next time.");
        c("gameover", "Continue...");
    }

    function fuckher7() {
        s("You hug her close to your body, but she gasps and struggles... 20 seconds was as long as she could take.");
        s(girltalk + "It's coming out - I can't stop it!");

        timeheld = thetime - lastpeetime;

        s("You quickly release her and she bounces out of bed, both hands pressed into her crotch.  You know the only thing holding in her pee now is her finger jammed into her pee hole.");
        s("She doesn't have far to go - the bathroom is steps from the bed.");
        s("She doesn't stop to close the door, and her pee begins flowing in a waterfall even before she sits on the toilet.  Her legs are open towards you and she's bent slightly forward, letting her firm breasts hang down.");
        s("The hissing is loud, and even from the bed you can smell a slight fragrance from the hot pee she held just for you.");
        s("You stare at the stream as it cascades from her crotch for nearly a minute, and you start to feel yourself getting hard again....");
        c("gamewon", "Continue...");
    }

    function breakmovie() {
        s("You try the door with your key...");
        if (bladder > blademer) {
            s(girltalk + sayhero[randcounter]);
            attraction += 3;
        }
        displayneed();
        displayyourneed();
        c("darkmovie", "Continue...");
    }


    function removie() {
        theaterkey = 0;
        pushloc("themovie");
        themovie();
    }

    //TODO fix thehold my purse
    function darkmovie() {
        if (locstack[0] !== "darkmovie") {
            s("You and " + girlname + " enter the movie theater.  It's dark, silent and deserted.");
            pushloc("darkmovie");
        } else {
            s("You are with " + girlname + " in the closed movie theater.");
        }

        showneed();
        displayyourneed();

        if (bladder > bladlose) wetherself();
        else if (yourbladder > yourbladlose) wetyourself();
        else if (gottagoflag > 0) preventpee();
        else {
            c("stealsoda", "Get a soda.");
            standobjs();
            if (!checkedherout) c("checkherout", "Check her out.");
            if (yourbladder > yourbladurge)
                c("youpee", "Go to the bathroom.");
            c("leavehm", "Leave the theater.");
        }
    }

    function themovie() {
        if (seenmovie && locstack[0] === "driveout" && thetime < theaterclosingtime) {
            s(girlname + " giggles: But we've already been to the theater, silly!");
            if (theaterkey > 0)
                c("removie", "But I found this key I have to return!");
            c(locstack[0], "Continue...");
        } else {
            if ((thetime < theaterclosingtime) || locstack[0] === "themovie") {
                if (locstack[0] !== "themovie") {
                    s("You and " + girlname + " arrive at the movie theater.");
                    pushloc("themovie");
                } else {
                    s("You are with " + girlname + " in the movie theater.");
                }

                showneed();
                displayyourneed();
                if (bladder > bladlose) wetherself();
                else if (yourbladder > yourbladlose) wetyourself();
                else {
                    if (gottagoflag > 0) {
                        preventpee();
                    } else {
                        c("buysoda", "Buy a soda.");
                        c("askmovie", "Ask her which movie she wants to watch.");
                        c("choosemovie", "Ask her to watch a movie.");
                        if (yourbladder > yourbladurge)
                            c("youpee", "Go to the bathroom.");
                        standobjs();
                    }
                    c("leavehm", "Leave The Movie Theater.");
                }
            } else itsclosed("themovie");
        }
    }

    function askmovie() {
        if (moviecounter === 0) {
            askedfavourite = 1;
            let moviename;
            if (favoritemovie === "theurge") moviename = "The Urge";
            if (favoritemovie === "thedesp") moviename = "Desperate Houswives";
            if (favoritemovie === "thectrl") moviename = "Control Yourself";
            if (favoritemovie === "thelitr") moviename = "2 Liters";
            s(girlname + "smiles at you.");
            s(girltalk + "I'd love to see " + moviename + ".");
            c("moviefavor", "Let's watch that then.");
            if (favoritemovie === "theurge")
                c("chooseothermovie", "Nah. Horror flicks are boring.");
            if (favoritemovie === "thedesp")
                c("chooseothermovie", "Nah. That's a chick flick!");
            if (favoritemovie === "thectrl")
                c("chooseothermovie", "Nah. College films are stupid.");
            if (favoritemovie === "thelitr")
                c("chooseothermovie", "Nah. I'm really not into crime and punishment.");
        } else {
            s(girlname + " laughs: Two movies in one night?  Let's go do something else!");
            c(locstack[0], "Continue...");
        }
    }

    function chooseothermovie() {
        s("The other movies that are playing:");
        if (favoritemovie !== "theurge")
            c("movieurge", "The Urge - <i>A horror flick</i>");
        if (favoritemovie !== "thedesp")
            c("moviedesp", "Desperate Housewives : The Movie");
        if (favoritemovie !== "thectrl")
            c("moviectrl", "Control Yourself - <i>A romantic comedy</i>");
        if (favoritemovie !== "thelitr")
            c("movielitr", "2 Liters, 25 Hours - <i>A police drama</i>");

    }

    function choosemovie() {
        if (moviecounter === 0) {
            s("There are many movies playing:");
            c("movieurge", "The Urge - <i>A horror flick</i>");
            c("moviedesp", "Desperate Housewives : The Movie");
            c("moviectrl", "Control Yourself - <i>A romantic comedy</i>");
            c("movielitr", "2 Liters, 25 Hours - <i>A police drama</i>");
        } else {
            s(girlname + " laughs: Two movies in one night?  Let's go do something else!");
            c(locstack[0], "Continue...");
        }
    }

    function movieurge() {
        moviechoice = 0;
        if (favoritemovie === "theurge") premoviepee(); else movieargue();
    }

    function moviedesp() {
        moviechoice = 1;
        if (favoritemovie === "thedesp") premoviepee(); else movieargue();
    }

    function moviectrl() {
        moviechoice = 2;
        if (favoritemovie === "thectrl") premoviepee(); else movieargue();
    }

    function movielitr() {
        moviechoice = 3;
        if (favoritemovie === "thelitr") premoviepee(); else movieargue();
    }

    function movieargue() {
        if (askedfavourite) {
            s("She looks like she wants to argue, but doesn't.");
            attraction -= 5;
            premoviepee()
        } else {
            let moviename;
            if (favoritemovie === "theurge") moviename = "The Urge";
            if (favoritemovie === "thedesp") moviename = "Desperate Houswives";
            if (favoritemovie === "thectrl") moviename = "Control Yourself";
            if (favoritemovie === "thelitr") moviename = "2 Liters";
            s(girlname + " looks you directly in the eyes and a pout forms on her lips.");
            s(girltalk + "But I wanna watch " + moviename + "!");
            c("moviefavor", "Okay.  But you owe me one.");
            if (favoritemovie === "theurge")
                c("premoviepee", "Nah. Horror flicks are boring.");
            if (favoritemovie === "thedesp")
                c("premoviepee", "Nah. That's a chick flick!");
            if (favoritemovie === "thectrl")
                c("premoviepee", "Nah. College films are stupid.");
            if (favoritemovie === "thelitr")
                c("premoviepee", "Nah. I'm really not into crime and punishment.");
        }
    }

    //TODO figure out moviename
    function moviefavor() {
        if (favoritemovie === "theurge") {
            moviename = "The Urge";
            moviechoice = 0;
        }
        if (favoritemovie === "thedesp") {
            moviename = "Desperate Houswives";
            moviechoice = 1;
        }
        if (favoritemovie === "thectrl") {
            moviename = "Control Yourself";
            moviechoice = 2;
        }
        if (favoritemovie === "thelitr") {
            moviename = "2 Liters";
            moviechoice = 3;
        }

        if (!askedfavourite) {
            owedfavor += 1;
        } else {
            attraction += 2;
        }
        premoviepee();
    }

    //TODO figure out duplicate continue's
    function premoviepee() {
        pushloc("domovie");
        changevenueflag = 1;//TODO probs delete
        showneed();
        displayyourneed();
        if (gottagoflag > 0) {
            c("holdit", "Ask her to hold it.");
            c("allowpee", "Let her go.");
        } else if (yourbladder > yourbladneed) {
            c("youpee", "Use the bathroom before watching the movie.");
            c(locstack[0], "Buy the tickets and head over to find the auditorium.");
        } else {
            s("You buy tickets and head over to find the auditorium.");
            c(locstack[0], "Continue...");
        }
    }

    //TODO you can go to the bathroom if you're desperate
    function domovie() {
        if (locstack[0] !== "domovie") {
            s("You and " + girlname + " enter the darkened theater.");
            pushloc("domovie");
            moviecounter = 0;
        } else {
            s("You are watching the movie.");
            moviecounter += 1;
        }

        seenmovie = 1;

        if (moviecounter >= 7) {
            s("The movie has ended.");
            poploc();
            changevenueflag = 1;
        } else {
            if (moviechoice === 0) s(moviedesc0[moviecounter]);
            else if (moviechoice === 1) s(moviedesc1[moviecounter]);
            else if (moviechoice === 2) s(moviedesc2[moviecounter]);
            else s(moviedesc3[moviecounter]);
        }

        s(girlname + " is sitting beside you.");
        if (randomchoice(4)) noteholding();

        showneed();
        displayyourneed();
        if (bladder > bladlose) wetherself();
        else if (yourbladder > yourbladlose) wetyourself();
        else {
            if (gottagoflag > 0) {
                preventpee();
            } else {
                c("movieromance", "Reach over and hold her hand.");
                c("moviesex", "Reach over and touch her thigh.");
                c("moviescary", "Lean closer to her.");
                c("moviedoh", "Look her in the eyes.");
            }
            if (moviecounter < 7) c("leavehm", "Leave the theater.");
        }
    }

    // moviedesc - 0 : Anticipate
    //             1 : Strange
    //             2 : Scary
    //             3 : Sexy
    //             4 : Romantic
    //             5 : Sexy
    //             6 : Romantic


    function movieromance() {
        s("You reach over and hold your hand in hers.");
        if (moviecounter === 4 || moviecounter === 6 || attraction > 30) {
            s("She gives your hand a squeeze.");
            attraction += 3;
            shyness -= 3;
        } else {
            s("Her hand is kind of cold.");
        }
        c(locstack[0], "Continue...");
    }

    function moviesex() {
        s("You reach over and brush her thigh lightly with the back of your hand.");
        if (moviecounter === 3 || moviecounter === 5 || attraction > 70) {
            s(thighresp[randcounter]);
            incrandom();
            attraction += 3;
            shyness -= 3;
        } else {
            s("She firmly moves your hand off her leg.");
        }
        c(locstack[0], "Continue...");
    }

    function moviescary() {
        s("You lean towards her.");
        if (moviecounter === 2 || attraction > 40) {
            s("She leans back toward you and puts her hand in yours.");
            attraction += 3;
            shyness -= 3;
        } else {
            s("She doesn't seem to notice.");
        }
        c(locstack[0], "Continue...");
    }

    function moviedoh() {
        s("You look over at her sitting beside you.");
        if (moviecounter === 1 || attraction > 50) {
            s("... and find her staring back at you.");
            s("Your eyes meet, and she smiles.");
            attraction += 3;
            shyness -= 3;
        } else {
            s("... and see her intently watching the movie.");
        }
        c(locstack[0], "Continue...");
    }


    // function rebar() {
    //     barkey = 0;
    //     pushloc("thebar");
    //     thebar();
    // }


    // //TODO fix you losing control scene.
    // //TODO fix boredom to be less harsh
    // //TODO have bartopics be ore random
    // function thebar() {
    //     //TODO figure out this mess of if statement combinations
    //     if (beenbar && locstack[0] === "driveout" && thetime < barclosingtime) {
    //         s(girlname + " giggles: But we've already been to the bar, silly!");
    //         if (barkey > 0)
    //             c("rebar", "But I found this key I have to return!");
    //         c(locstack[0], "Continue...");
    //     } else {
    //         if ((thetime < barclosingtime) || locstack[0] === "thebar") {
    //             if (locstack[0] !== "thebar") {
    //                 s("You and " + girlname + " enter the Bar, taking a couple of stools about halfway down.");
    //                 pushloc("thebar");
    //             } else {
    //                 s("You are with " + girlname + " in the Bar.");
    //                 if (randomchoice(3)) noteholding();
    //                 else if (randomchoice(5)) interpbladder();
    //             }
    //             displayyourneed();
    //             beenbar = 1;
    //             showneed();
    //
    //
    //             if (bladder > bladlose) wetherself();
    //             else if (yourbladder > yourbladlose) wetyourself();
    //             else {
    //                 if (gottagoflag > 0) {
    //                     preventpee();
    //                 } else {
    //                     if (bartopic < 5 && gottagoflag < 1) {
    //                         s(girltalk + bartalk[bartopic]);
    //                     } else if (gottagoflag < 1 && bladder < blademer) {
    //                         s(barmedresp[randcounter]); // she's bored
    //                         incrandom();
    //                         attraction -= 1;
    //                     }
    //                     if (bartopic < 5) {
    //                         const ansorder = Math.floor(Math.random() * 3);
    //                         if (ansorder === 0) {
    //                             c("bartalkgood", bargoodans[bartopic]);
    //                             c("bartalkmed", barmedans[bartopic]);
    //                             c("bartalkbad", barbadans[bartopic]);
    //                         } else if (ansorder === 1) {
    //                             c("bartalkmed", barmedans[bartopic]);
    //                             c("bartalkgood", bargoodans[bartopic]);
    //                             c("bartalkbad", barbadans[bartopic]);
    //                         } else {
    //                             c("bartalkbad", barbadans[bartopic]);
    //                             c("bartalkgood", bargoodans[bartopic]);
    //                             c("bartalkmed", barmedans[bartopic]);
    //                         }
    //                     }
    //                     c("buybeer", "Buy a beer.");
    //                     if (barkey < 1) c("lookaround", "Look around.");
    //                     if (bartopic > 4 && gottagoflag < 1) noflirtflag = 0; else noflirtflag = 1;
    //                     standobjs();
    //                     if (yourbladder > yourbladurge)
    //                         c("youpee", "Go to the bathroom.");
    //                 }
    //                 c("leavehm", "Leave the bar.");
    //             }
    //         } else itsclosed("thebar");
    //     }
    // }

    function failmakeout() {
        shyness += 10;
        attraction -= 10;
        s(girltalk + "I don't feel comfortable going up there with you.");
        s(girltalk + "Please let's go somewhere else.");
        displayneed();
        displayyourneed();
        c(locstack[0], "Okay.  Sorry.");
    }

    function themakeout() {
        if (locstack[0] !== "themakeout") {
            if (attraction > gomakeoutthresh) {
                s("You and " + girlname + " drive up to the make-out spot.  It's dark and deserted, but has a beautiful view of the stars.");
                pushloc("themakeout");
            } else {
                s("You start to drive out to the makeout spot, up a winding hilly road.");
                s(girltalk + "Hey! Where are we going?");
                c("failmakeout", "There's this nice secluded spot I know...");
                c(locstack[0], "Ummmm... Actually I'm not sure.");
                return 0;
            }
        } else {
            s("You and " + girlname + " are at the make-out spot.");
            if (randomchoice(3)) noteholding();
            else if (randomchoice(5)) interpbladder();
        }

        beenmakeout = 1;
        showneed();
        displayyourneed();
        if (bladder > bladlose) wetherself();
        else if (yourbladder > yourbladlose) wetyourself();
        else {
            if (gottagoflag > 0) {
                preventpee();
                c("peeoutside", "Suggest that she pee outside.");
            } else {
                c("viewstars", "Suggest that you gaze at the stars.");
                c("thewalk", "Invite " + girlname + " to take a walk.");
                if (theaterkey < 1) c("lookaround", "Look around.");
                standobjs();
                if (yourbladder > yourbladurge)
                    c("ypeeoutside", "Pee outside.")
            }
            c("leavehm", "Drive off.");
        }
    }

    //TODO only round numbers
    function viewstars() {
        s("You hold hands and stare into the sky together.");
        displayneed();
        const rand = randomchoice(7);
        if (rand) {
            if (bladder < blademer && tummy > 30) {
                if (tummy >= blademer - bladder) {
                    tummy -= (blademer - bladder);
                    bladder = blademer;
                } else {
                    bladder += tummy;
                    tummy = 0;
                }
                s("The cold weather works some magic on " + girlname + "'s bladder.");
                displayneed();
            }
        } else {
            if (yourbladder < yourblademer && tummy > 30) {
                if (yourtummy >= yourblademer - yourbladder) {
                    yourtummy -= (yourblademer - yourbladder);
                    yourbladder = yourblademer;
                } else {
                    yourbladder += yourtummy;
                    yourtummy = 0;
                }
                //TODO better description
                s("The cold weather works some magic on your bladder.");
                displayyourneed();
            }
        }
            if (flirtcounter < 1) attraction += 5;
            flirtcounter += 4;
            c(locstack[0], "Continue...");
    }

    function thewalk() {
        if (locstack[0] !== "thewalk") {
            s("You and " + girlname + " decide to take a walk.  It's a warm, still night.");
            walkcounter = 0;
            pushloc("thewalk");
        } else {
            s("You and " + girlname + " are talking a walk together.");
        }

        showneed();
        displayyourneed();
        s(walkdesc[randcounter]);
        walkcounter++;
        if (bladder > bladlose) wetherself();
        else if (yourbladder > yourbladlose) wetyourself();
        else {
            if (randcounter === 5) {
                c("examinegate", "Investigate the open gate.");
            }
            incrandom();
            if (gottagoflag > 0) {
                preventpee();
                c("peeoutside", "Suggest that she pee on the ground.");
            } else {
                if (yourbladder > yourbladurge)
                    c("ypeeoutside", "Pee outside.");
                standobjs();
                c(locstack[0], "Keep walking...");
            }
            c("goback", "Walk back to the car.");
        }
    }

    function examinegate() {

        s("You slowly open the gate and peer behind.");
        if (walkcounter < 10) {
            s("The yard beyond is dark, illuminated only by starlight.");
            if (shyness < 30 && attraction > 75) {
                s(girltalk + "Hey!  Let's check it out.");
                c("theyard", "Take her into the dark yard.");
            }
        } else {
            s(girlname + " gasps: We've made it to the beach!");
            s("There's sand beyond the gate, and you can hear the calm waves breaking on the shore.");
            c("thebeach", "Visit the beach.");
        }
        c(locstack[0], "Continue onward...");
    }

    function theyard() {
        if (locstack[0] !== "theyard") {
            s("You and " + girlname + " quietly enter the yard.  The grass is soft and slightly damp under your feet.");
            pushloc("theyard");
        } else {
            s("You and " + girlname + " are in somebody's back yard.");
        }

        s("There is a hot tub here.");

        showneed();
        displayyourneed();
        if (bladder > bladlose) wetherself();
        else if (yourbladder > yourbladlose) wetyourself();
        else {
            c("prehottub", "Suggest you take a dip in the tub.");
            c("kissher", "Kiss her.");
            c("feelup", "Feel her up.");
            if (gottagoflag > 0) {
                preventpee();
                c("peeoutside", "Suggest that she pee on the ground.");
            } else {
                standobjs();
                if (!checkedherout) c("checkherout", "Check her out.");
            }
            if (yourbladder > yourbladurge)
                c("ypeeoutside", "Pee outside.");
            c("goback", "Leave the yard.");
        }
    }

    function prehottub() {
        if (attraction > hottubthresh && shyness < 12) {
            s(girltalk + "Are you sure it's going to be alright?  What if somebody sees us?");
            showneed();
            displayyourneed();
            c("thehottub", "Don't worry - it's really dark out here.");
            c(locstack[0], "I'm not so sure...");
        } else {
            s(girltalk + "But I didn't bring a bathing suit!");
            c(locstack[0], "I guess not...");
        }
    }

    //TODO she can pee in the hottub if she's not about to burst
    //TODO fix need dialogue
    function thehottub() {
        if (locstack[0] !== "thehottub") {
            s("You and " + girlname + " quickly strip off your clothes in the cover of the dark yard.");
            s("You slip into the warm water of the hot tub, and watch as " + girlname + ", now completely nude, steps in to join you.");
            s("She looks so sexy in the starlight, her pussy masked in darkness and her erect nipples silhouetted against the dim sky.");
            s("Though it is dark, your eyes caress the shadows of her tight curves as they slowly submerge next to you.");
            pushloc("thehottub");
        } else {
            s("You and " + girlname + " are in the hot tub.");
        }

        showneed();
        displayyourneed();
        if (bladder > bladlose) wetherself();
        else if (yourbladder > yourbladlose) wetyourself();
        else {
            c("kissher", "Kiss her.");
            c("feelup", "Feel her up.");
            if (attraction >= 130 && shyness <= 0) {
                c("tubsex", "Make out with her.");
            }
            if (gottagoflag > 0) {
                preventpee();
                c("peeintub", "Suggest that she pee in the tub.");
            } else {
                standobjs();
                if (yourbladder > yourbladurge)
                    c("ypeeintub", "Pee in the hottub.");
            }
            c("goback", "Get out of the tub.");
        }
    }


    function thebeach() {
        if (locstack[0] !== "thebeach") {
            s("You and " + girlname + " walk out onto the sand.  It makes a soft swooshing noise as you step, like boots on dry snow.");
            pushloc("thebeach");
            askedswim = 0;
        } else {
            s("You and " + girlname + " are on the dark beach.");
            if (askedswim > 0) askedswim--;
        }

        if (bladder > blademer && shyness > 15 && !askedswim) {
            displayneed();
            askedswim = 7;
            s(girltalk + " Hey!  Want to go for a swim together?");
            s(girlname + " seems strangely insistent.  You realize that neither of you has swimming gear, so this means you get to see her naked.  Or at least see as much as you can in the dark.");
            c("beachswim", "Sure, let's go for a swim!");
            c(locstack[0], "Nah.  We didn't bring swimsuits.");
        } else {
            showneed();
            displayyourneed();
            if (bladder > bladlose) wetherself();
            else if (yourbladder > yourbladlose) wetyourself();
            else {
                if (gottagoflag > 0) {
                    preventpee();
                    c("peeoutside", "Suggest that she pee on the sand.");
                } else {
                    c("kissher", "Kiss her.");
                    c("feelup", "Feel her up.");
                    if (attraction > 100 && shyness < 10)
                        c("beachsex", "Make out with her.");
                    standobjs();
                    if (!checkedherout) c("checkherout", "Check her out.");
                    if (yourbladder > yourbladurge)
                        c("ypeeoutside", "Pee on the sand.");
                }
                c("goback", "Leave the beach.");
            }
        }
    }

    function beachswim() {
        pushloc("beachswim");
        s(girlname + swimstripquote);
        if (pantycolor === "none")
            s(swimstripquotebare);
        else
            s(swimstripquotepanties);
        c("beachswim2", "Join her.");
        if (pantycolor !== "none")
            c("beachswim2b", "Tell her that her panties are going to get wet.");
        c("beachswim2c", "Stand and watch.");
    }

    function beachswim2() {
        s("You peel off your clothes and take her hand, walking slowly into the warm water.");
        displayneed();
        displayyourneed();
        s("It's dark, so you can't really see what she's doing.  You hear the swooshing of the water as you walk together.");
        c("beachswim3b", "Take her in your arms ...");
        c("beachswim3", "Continue ...");
    }

    function beachswim2b() {
        s("<b>YOU:</b> But your panties - they'll get wet!");
        s(girltalk + " How do you know they're not already wet?");
        s("She has a point there.");
        c("beachswim2", "Continue ...");
    }

    function beachswim2c() {
        if (pantycolor === "none")
            s(girlname + " is standing beside you naked in the dark.");
        else
            s(girlname + " is standing beside you in her " + pantycolor + " panties in the dark.");
        s(girltalk + " Aren't you going to come with me?");
        displayneed();
        displayyourneed();
        s("How can you resist the invitation of a sexy, naked girl to join her swimming?");
        c("beachswim2", "Of course I'll come with you.");
    }

    function beachswim3() {
        s("You walk hand in hand with " + girlname + " until you're waist deep in the calm water.");
        if (pantycolor === "none")
            s(girlname + " gasps as a wave touches her naked crotch.");
        else
            s(girlname + " gasps as a wave soaks the crotch of her " + pantycolor + " panties.");
        s("She squeezes your hand and you sense a shiver running up her spine.");
        c("beachswim4b", "Feel her up.");
        c("beachswim4", "Continue...");
    }

    function beachswim3b() {
        s("You take " + girlname + " in your arms and hug her close to you, standing knee-deep in the calm water.");
        s("She pulls her belly away from you and gasps, but you grab her butt and press it into your thigh.");
        if (pantycolor === "none")
            s("Her quivering bare pussy lips feel so wonderful pressed into your upper leg.");
        else
            s("Her warm, wet panties feel wonderful pressed into your upper leg.");
        s("<b>I've <u>really</u> got to pee!</b> she confesses, whispering in your ear.");
        c("beachswim4b", "Hold her close.");
        c("beachswim4", "Let her go.");
    }

    function beachswim4() {
        s(girlname + " pauses for a moment, and over the sound of the surf, you can barely hear the hiss of her urine hitting the water.");
        flushdrank();
        if (pantycolor === "none")
            s("She's right there beside you in the dark, naked and peeing into the water.");
        else
            s("She's right there beside you in the dark, peeing through her wet panties into the water.");
        c("beachswim5", "Continue ...");
    }

    function beachswim4b() {
        s(girlname + " pauses for a moment.");
        s("You run your hand up her smooth leg under the water.");
        s("The water is even warmer around her crotch.  Probing closer, you feel a jet of hot pee escaping from between her pussy lips, passing through your fingers and warming your leg.");
        flushdrank();
        s("You feel it slow, spurt a couple of times, and finally come to a stop.");
        c("beachswim5", "Continue ...");
    }

    function beachswim5() {
        s(girltalk + " maybe we should go back.  Could be sharks, you know!");
        s("You take her hand and lead her back to the beach where you dry off as well as you can and put your clothes back on.");
        if (pantycolor !== "none") {
            s("She hands you her wet panties.");
            s(girltalk + "Is there someplace you can put these?");
            wetpanties += 1;
            pantycolor = "none";
        }
        c("goback", "Continue ... ");
    }

    function tubsex() {
        if (locstack[0] !== "tubsex") {
            kisscounter = 0;
            pushloc("tubsex");
            arousal = 0;
            s("You pull " + girlname + " on your lap.");
            xskirt = 1;
            xtop = 1;
            xbra = 1;
            xpanties = 1;
        } else {
            s(girlname + " is sitting on your lap... naked.")
        }

        if (kisscounter > maxkiss) {
            s(girlname + " suddenly pulls away to sit back next to you.");
            s(girltalk + "You know, this just isn't working out.");
            resetclothes();
            if (rstmoves === 1) {
                resetmoves();
            }
            c("goback", "Continue...");
        }

        displayneed();
        displayyourneed();

        if (arousal < 40) {
            s("She seems very aroused.");
        } else if (arousal < 70) {
            s("She seems extremely aroused.");
        } else if (arousal < 100) {
            s("She seems unbelievably aroused.");
        } else if (arousal < 140) {
            s("She seems earthshatterinly aroused.");
        } else {
            s("She seems madly hot, but still reluctant to take that last step here in the hot tub.");
        }

        s("What will you do?");

        c("kissher", "Kiss her on the mouth.");
        if (!tthigh) c("touchthigh", "Touch her thigh");
        if (!tbreast) c("touchbreast", "Touch her breasts");
        if (!tass) c("touchass", "Touch her ass");
        if (!tpussy) c("touchpussy", "Touch her pussy");
        if (!kneck) c("kissneck", "Kiss her on the neck");
        if (!kbreast) c("kissbreast", "Kiss her on the nipple");
        if (arousal > 120) c("fucktry", "Fuck her");
        c("goback", "Lift her off of your lap.");

    }

    //TODO when making out attraction and shyness are updated?
    function beachsex() {
        if (locstack[0] !== "beachsex") {
            kisscounter = 0;
            pushloc("beachsex");
            arousal = 0;
            if (bladder > bladlose)
                s(girlname + " collapses onto the soft sand, pulling you on top of her.");
            else
                s(girlname + " pulls you down onto the soft sand.");
        } else {
            s("You are lying on the beach with " + girlname);
        }

        if (kisscounter > maxkiss) {
            s(girlname + " suddenly pulls away from you and sits up.");
            s(girltalk + "You know, this just isn't working out.");
            c("goback", "Continue...");
            resetclothes();
            if (rstmoves === 1) {
                resetmoves()
            }
        } else {

            displayneed();
            displayyourneed();
            if (pantycolor === "none") xpanties = 1;

            if (arousal < 40) {
                s("She seems very aroused.");
            } else if (arousal < 70) {
                s("She seems extremely aroused.");
            } else if (arousal < 100) {
                s("She seems unbelievably aroused.");
            } else if (arousal < 140) {
                s("She seems earthshatterinly aroused.");
            } else {
                s("She seems madly hot, but still reluctant to take that last step out here on the beach.");
            }

            s("What will you do?");

            c("kissher", "Kiss her on the mouth.");
            if (!tthigh && xskirt) c("touchthigh", "Touch her thigh");
            if (!tbreast && xtop) c("touchbreast", "Touch her breasts");
            if (!tass && xskirt) c("touchass", "Touch her ass");
            if (!tpussy && xskirt) c("touchpussy", "Touch her pussy");
            if (!kneck) c("kissneck", "Kiss her on the neck");
            if (!kbreast && xbra) c("kissbreast", "Kiss her on the nipple");
            if (!kthigh && xskirt) c("kissthigh", "Kiss her on the thigh");
            if (!kpussy && xskirt) c("kisspussy", "Kiss her on the pussy");
            if (!xskirt) c("toskirt", sextakeoffskirt);
            if (!xtop) c("totop", sextakeoffblouse);
            if (!xbra && xtop) c("tobra", "Take off her bra");
            if (!xpanties && xskirt) c("topanties", "Take off her panties");
            if (arousal > 120 && xskirt && xpanties) c("fucktry", "Fuck her");
            c("goback", "Get back up and dust yourself off.");
        }
    }

    function fucktry() {
        s("You try to put it in, but she pushes you away");
        s(girltalk + " Not here.  Later.");
        resetclothes();
        c("goback", "Continue...");
    }

    function gameover() {
        document.getElementById('textsp').innerHTML += "<p class='title'>Game Over, Dude! </p>"
            + "<p style='text-align: center; padding-right: 10%; font-style: italic'>You struck out</p>";
        s("<br>&nbsp;<br>&nbsp;");
        s("<br>&nbsp;<br>&nbsp;");
        s("<br>&nbsp;<br>&nbsp;");
        s("<div style='text-align:right'><i>Hit Reload to start over...</i></div>");
    }

    function gamewet() {
        document.getElementById('textsp').innerHTML += "<p class='title'>Woot! </p>"
            + "<p style='text-align: center; padding-right: 10%; font-style: italic'>you took her to bed while she was bursting</p>"
            + "<p style='text-align: center; padding-right: 10%; font-style: italic'>and she held it for you until she wet the bed.</p>";
        s("<br>&nbsp;<br>&nbsp;");
        s("Final Stats:");
        s("Time since last pee:" + timeheld + " minutes");
        s("Bladder contained:" + bladder + " ml");
        s("<br>&nbsp;<br>&nbsp;");
        s("<div style='text-align:right'><i>Hit Reload to start over...</i></div>");
    }

    function gamewon() {
        document.getElementById('textsp').innerHTML += "<p class='title'>You Won!! </p>"
            + "<p style='text-align: center; padding-right: 10%; font-style: italic'>you took her to bed while she was bursting.</p>";
        s("<br>&nbsp;<br>&nbsp;");
        s("Final Stats:");
        s("Time since last pee:" + timeheld + " minutes");
        s("Bladder contained:" + bladder + " ml");
        s("<br>&nbsp;<br>&nbsp;");
        s("<div style='text-align:right'><i>Hit Reload to start over...</i></div>");
    }

</script>
<!--TODO fix text flicker when start is loaded with picture-->
<link rel="stylesheet" type="text/css" href="unused/stylechange.css">
<div class="fullscreen">
    <div id="backpack-cnt">
        <div id="backpackcontent">
            <span id="closebackpack">&times;</span>
            <p>This is your backpack</p>
            <div id="item-text">

            </div>
            <div class="btn-group" id="backpackitems">
                <button onclick="selectitem('Soda')" class="itembtn" id="Soda">Soda</button>
                <button onclick="selectitem('Water')" class="itembtn" id="Water">Water</button>
                <button onclick="selectitem('Cocktail')" class="itembtn" id="Cocktail">Cocktail</button>
                <button onclick="selectitem('Champagne')" class="itembtn" id="Champagne">Champagne</button>
            </div>
        </div>
    </div>
    <div id="titlebar">
        <div id="credits">Game Engine 3.2a by drw</div>
        <div id="version">VER 4.2: June 24, 2020</div>
    </div>
    <br>
    <hr>
    <br>
    <div id="gamescreen">
        <div id="picture">
            <pre id="thepic"></pre>
        </div>
        <div id="textsp">
            <p class="title">Melissa Explains it All </p>
            <p style="text-align: center">This game contains mature content.</p>
            <!--            TODO change class-->
            <ul id="choices" class="choices-start">
                <li class="choices-items-start"><a href='javascript:go("start")'>Continue</a></li>
                <li class="choices-items-start"><a href='javascript:go("under18")'>Leave</a></li>
                <li class="choices-items-start"><a href='javascript:Object.keys(objects).forEach(key => objects[key].value = 2);'>All Items</a></li>
            </ul>
            <pre style="padding-top: 10vh;padding-left:30vw;"><br>  ((<br>  -))<br>  /\) <br> ( |)<br>   \ \<br>   _/ )<br>  //-/<br>  ||<br>  d/<br></pre>
        </div>
        <a href="javascript:backpack()"><img id="backpack" src="icons/backpack.png" alt="Picture of girl" class="pic"></a>
    </div>
    <div id="statsp">
        <table id="stats-bar">
            <tbody>
            <tr>
                <td>&nbsp;</td>
                <td class="stats-cells"><small>Money</small></td>
                <td class="stats-cells"><small>Attraction</small></td>
                <td class="stats-cells"><small>Shyness</small></td>
                <td class="stats-cells"><small>Tummy</small></td>
                <td class="stats-cells"><small>Her Bladder</small></td>
                <td class="stats-cells"><small>Time</small></td>
                <td class="stats-cells"><small>Your Tummy</small></td>
                <td class="stats-cells"><small>Your Bladder</small></td>
            </tr>
            <tr>
                <!--                TODO fix this-->
                <td>&nbsp;</td>
                <td id="mon" class="stats-cells-blue">$200</td>
                <td id="att" class="stats-cells-white">10</td>
                <td id="shy" class="stats-cells-blue">90</td>
                <td id="tum" class="stats-cells-white">92</td>
                <td id="blad" class="stats-cells-blue">308</td>
                <td id="time" class="stats-cells-white">7:02 PM</td>
                <td id="ytum" class="stats-cells-blue">190</td>
                <td id="yblad" class="stats-cells-white">510</td>
            </tr>
            </tbody>
        </table>
        <div id="objsp">You are carrying: nothing.</div>
    </div>
</div>

</body>
</html>
