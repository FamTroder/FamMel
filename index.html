<!--suppress XmlHighlighting -->
<html lang="en">
<head>
    <meta charset="UTF-8">
<!-- TODO sort out imports?-->
    <script src="scripts/main.js"></script>
    <script src="scripts/quotes.js"></script>
    <script src="scripts/animation.js"></script>
    <script src="scripts/settings.js"></script>
    <script src="scripts/images.js"></script>
    <script src="scripts/yourhome.js"></script>
    <script src="scripts/objects.js"></script>
    <script src="scripts/actions.js"></script>
    <script src="scripts/bladder.js"></script>
    <script src="scripts/yourbladder.js"></script>
    <script src="scripts/clothes.js"></script>
    <script src="scripts/herhome.js"></script>
    <script src="scripts/drive.js"></script>
    <script src="scripts/locations/driveAround.js"></script>
    <script src="scripts/locations/theBar.js"></script>
    <script src="scripts/locations/theClub.js"></script>
    <script src="scripts/locations/theatre.js"></script>
    <script src="scripts/locations/theMakeOut.js"></script>
    <script src="scripts/locations.js"></script>
    <script src="scripts/games/darts.js"></script>
    <script src="scripts/fuckHer.js"></script>
    <script src="scripts/debugFunctions.js"></script>
    <script src="scripts/pop-up.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/showdown@1.9.1/dist/showdown.min.js"></script>
    <title>Melissa Explains it All</title>
</head>
<body>
<!--TODO fix text flicker when start is loaded with picture-->
<link rel="stylesheet" type="text/css" href="style.css">
<div class="fullscreen">
    <div id="pop-up">
        <div id="pop-up-content">
            <span id="close-pop-up">&times;</span>
            <span id="pop-up-title" class="title">backpack</span>
            <hr>
            <div id="pop-up-text">
                <p>This is your backpack</p>
                <div id="item-text"></div>
                <div class="btn-group" id="backpackitems"></div>
            </div>
        </div>
        </div>
    </div>
    <div id="titlebar">
        <div id="engine">Base Game by drw</div>
        <div id="version">VER 4.2: June 24, 2020</div>
    </div>
    <br>
    <hr>
    <br>
    <div id="gamescreen">
        <div id="picture">
            <pre id="thepic"></pre>
        </div>
        <div id="textsp">
            <p class="title">Melissa Explains it All </p>
            <p style="text-align: center">This game contains mature content.</p>
            <!--            TODO change class-->
            <ul id="choices" class="choices-start"></ul>
            <pre style="padding-top: 13vh;padding-left:30vw;"><br>  ((<br>  -))<br>  /\) <br> ( |)<br>   \ \<br>   _/ )<br>  //-/<br>  ||<br>  d/<br></pre>
            <br><br><p style="text-align: center"> Follow this project on github:</p>
            <p style="text-align: center"><a href="https://github.com/FamTroder/FamMel"><img src="icons/GitHub-Mark-32px.png" ></a></p>
        </div>
        <a href="javascript:backpack()"><img id="backpack" src="icons/backpack.png" alt="Picture of girl" class="pic"></a>
    </div>
    <div id="statsp">
        <table id="stats-bar">
            <tbody>
            <tr>
                <td>&nbsp;</td>
                <td class="stats-cells"><small>Money</small></td>
                <td class="stats-cells"><small>Attraction</small></td>
                <td class="stats-cells"><small>Shyness</small></td>
                <td class="stats-cells"><small>Tummy</small></td>
                <td class="stats-cells"><small>Her Bladder</small></td>
                <td class="stats-cells"><small>Time</small></td>
                <td class="stats-cells"><small>Your Tummy</small></td>
                <td class="stats-cells"><small>Your Bladder</small></td>
            </tr>
            <tr>
                <!--                TODO fix this-->
                <td>&nbsp;</td>
                <td id="mon" class="stats-cells-blue">$200</td>
                <td id="att" class="stats-cells-white">10</td>
                <td id="shy" class="stats-cells-blue">90</td>
                <td id="tum" class="stats-cells-white">92</td>
                <td id="blad" class="stats-cells-blue">308</td>
                <td id="time" class="stats-cells-white">7:02 PM</td>
                <td id="ytum" class="stats-cells-blue">190</td>
                <td id="yblad" class="stats-cells-white">510</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<script>


    //TODO potentially clean up if statements with multiple locations
    //TODO fix replacing whole arrays if not needed

    // Debug Parameters
    let enableimages = 0; // 0 = Disable image loading
    let enableascii = 1; // 0 = Disable ascii art display
    let enablehide = 0; // 1 = Hide screen

    let showstats = 1; // 1 = Show her bladder state, etc.
    // Girl Selection Parameters
    let photoChoice; //How she's dressed for photogame


    let favoritemovie = "theurge";
    let suggestedloc = "thebar";

    let heroutfit = "jeans";  //  Her clothing choice for the date
                              //  Possible values: skirt, jeans

    const clubclosingtime = 7 * 60; // 2:00AM
    const theaterclosingtime = 3 * 60; // 10:00PM last showing
    const barclosingtime = 6 * 60; // 1:00AM

    let money = 200;
    let attraction = 10;
    let tummy = 100;
    let bladder = 300;
    let shyness = 90;

    let tumavg = tummy; // Average blood water level
    const tumdecay = 6; // Number of calculation cycles to average bladder filling

    let lastmoney = money;
    let lastattraction = attraction;
    let lastshyness = shyness;

    let hour = 7;
    let minute = 0;
    let meridian = "PM";
    const timespeed = 2;
    let thetime = 0;

    // Fucking Parameters, mostly to figure out what she still has on.
    let arousal = 0;
    let kisscounter = 0;
    let feelcounter = 0;
    let fuckingnow = 0; // You are in the middle of fucking.
    let multiplemoves = 1;
    let rstmoves = 0; //Whether the sex moves reset after a make-out session
    //Formatting Parameters
    let slopen = 0; // Formatting : flags if string has been placed.
    let imageprev = "imgs/Laura/pixnorm.gif";  // Previous image
    const imagedesc = '"Picture of girl"';
    let imagename = imageprev;  // Actual picture.  Goes to default after 1 turn.
    let comma = 0; // used in formatting posessions.

    //Counter Parameters
    const maxkiss = 7; // maximum number of kisses that have effect.
    const maxfeel = 7; // maximum number of feel-ups that have effect

    const randmax = 5; // Maximum value of random counter
    let pstorycounter = 0;

    let posectr = 0; // keep track of which pose is next/last.
    const posemax = 5; // Maximum value of pose counter

    let outfitctr = 0; // keep track of the outfit being worn.
    const outfitmax = 5; // maximum count of outfits


    //  Location handling stack
    //  initialized at the start.
    const locstack = Array(); //The first element in the Array is the current location

    //  flags
    // Indicates new venue change
    let didintro = 0; // Flag for having done introduction
    let onphone = 0; // Flag for being on the phone with her
    let shopping = 0;// Flag for being in the shop
    let beenmakeout = 0; // Seen a movie already
    let flirtedflag = 0; // Actually a counter.  Keeps track of flirting.
    const maxflirts = 2; // Maximum flirt points per venue
    //TODO lockedflags  should probably be renamed counters
    let rrlockedflag = 0; // Restroom was locked last time she went
    let yrrlockedflag = 0;
    let askedswim = 0; // She's asked about a swim
    let wetthecar = 0; // Seat of the car is wet
    let shespurted = 0; // She only spurted
    let brokeice = 0; // She's previously brought up that she needs to pee
    let sawherpee = 0; // You've seen her pee
    let haveherpurse = 0; // You're holding her purse
    let late = 0; //You are late to pick her up

    let bartopic = 0; // Topics of discussion at the bar.
    let noflirtflag = 0; // Suppress flirty options

    let externalflirt = 0; // You flirted with somebody else

    // Girl stats(Counter and Flags)
    let owedfavor = 0; // she owes you a favor
    let flirtcounter = 0; // time since last flirt ( counts by 2 )
    let wetlegs = 0; // her legs are wet
    let wetherpanties = 0; // did she ever wet herself?
    let prepeed = 0; // did she pee before you picked her up
    let champagnecounter = 0; // Number of glasses of champagne served.
    let drankChamp = 0; // Time since last champagne glass was drunk.
    let gottagoflag = 0; // has she just asked to use the restroom
    let showedneed = 0; // has she just visually displayed her need
    let changevenueflag = 0; // you are changing venue - makes her easily ask to pee.
    let moviecounter = 0; // Keep track of location in movie
    let moviechoice; //  Which movie are we showing
    let askedfavourite = 0; //asked her which movie to watch

    let askholditcounter = 0; // How many times have you asked her to hold it.
    let waitcounter = 0; // how long ago did she ask to pee?
                         //Reset positive when you ask her.

    let nowpeeing = 0; // She is currently peeing
    let ynowpeeing = 0; // You're currently peeing
    let checkedherout = 0; // Flags that you just checked her out.

    let walkcounter = 0; // How far have you walked
    let elevatorwaitcounter = 0;



    /*
  -----------------------------------------------------------------
  GAME TEXT

   Most, but not all of the text in the game is stored in arrays.
   Note that all text with the girl's name in it has to be redefined
   later ( options dialog ) if the name of the girl is changed.
  -----------------------------------------------------------------
*/

    //
    //
    //  First set all the clothing related variables we're going to
    //  have as globals...  This is so she can have different outfits
    //  in normal life.  It's a lot of work, isn't it?
    //
    //

    let feelher;
    let feelres;
    let feelpee;
    let posenorm;
    let poseoutfit;
    let donoutfit;
    let donemer;
    let fillchampok;
    let stareather_laura;
    let stareather_karen;
    let stareather_jennifer;
    let stareather_melissa;
    let stareather;
    let dryquote;
    let peeshotquote;
    let peetowelquote;
    let peeoutsidequote;
    let peeoutsidequotebare;
    let peeoutsidebquote;
    let peeoutsidebquotebare;
    let wetherselfquote;
    let firstmtgquote;
    let firstmtgtightquote;
    let firstmtgtightquotebare;
    let soakedseatquote;
    let peeprepquotebare;
    let undressquote;
    let undressquoteemer;
    let ptogetherdumpquote;
    let ptogetherdumpquotebare;

    let sextoskirtquoteemer;
    let swimstripquote;
    let swimstripquotebare;
    let swimstripquotepanties;

/*

  -----------------------------------------------------------------

  DISPLAY MECHANICS

  Stuff that writes to the screen.

  -----------------------------------------------------------------

*/
    // Cache a statement
    //    t - the text to display.
    function s(t) {
        document.getElementById('textsp').innerHTML += t + "<p>";
    }

/*

  -----------------------------------------------------------------

  STORY PARTS

  Separate parts of the story, in more or less order.

  -----------------------------------------------------------------

*/

    function startChoices(){
        const listenerList = [
            [["start", "Play"], "start"],
            [["under18", "Leave"], "leave"],
            [[changeLog, "Changelog"], "changeLog", false],
            [[showCredits, "Credits"], "creditss", false]
        ];
        let html = "";
        listenerList.forEach(item => html += cListenerString(item[0], item[1]));
        document.getElementById("choices").innerHTML = html;
        listenerList.forEach(item => {
            document.getElementById(item[1]).classList.add("choices-items-start");
        })
        addListenersList(listenerList);
    }

    startChoices();

</script>
</body>
</html>
